Command line
python /home/ec2-user/anaconda3/envs/python3/bin/chemprop_train --data_path NH3_protease_inhibitor_processed_classification.csv --dataset_type classification --target_columns bin_activity --smiles_columns smiles --save_dir chemprop_NH3_classification_withpreds --split_type scaffold_balanced --num_folds 5 --ensemble_size 3 --metric auc --extra_metrics prc-auc accuracy --epochs 80 --save_preds --gpu 0 --num_workers 0
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'NH3_protease_inhibitor_processed_classification.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 80,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['prc-auc', 'accuracy'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'prc-auc', 'accuracy'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'chemprop_NH3_classification_withpreds',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'scaffold_balanced',
 'target_columns': ['bin_activity'],
 'target_weights': None,
 'task_names': ['bin_activity'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total scaffolds = 65 | train scaffolds = 50 | val scaffolds = 7 | test scaffolds = 8
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 33 | target average = 1.000000


Scaffold 1
Task 0: count = 24 | target average = 0.041667


Scaffold 2
Task 0: count = 21 | target average = 0.000000


Scaffold 3
Task 0: count = 21 | target average = 1.000000


Scaffold 4
Task 0: count = 14 | target average = 0.000000


Scaffold 5
Task 0: count = 12 | target average = 0.083333


Scaffold 6
Task 0: count = 9 | target average = 0.000000


Scaffold 7
Task 0: count = 7 | target average = 1.000000


Scaffold 8
Task 0: count = 6 | target average = 0.000000


Scaffold 9
Task 0: count = 6 | target average = 0.000000


Class sizes
bin_activity 0: 69.12%, 1: 30.88%
Total size = 353 | train size = 282 | val size = 35 | test size = 36
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.375000
Validation prc-auc = 0.065217
Validation accuracy = 0.914286
Epoch 1
Loss = 6.3152e-01, PNorm = 34.0335, GNorm = 0.2481, lr_0 = 9.8826e-04
Validation auc = 0.468750
Validation prc-auc = 0.075000
Validation accuracy = 0.914286
Epoch 2
Validation auc = 0.656250
Validation prc-auc = 0.107143
Validation accuracy = 0.914286
Epoch 3
Loss = 6.1851e-01, PNorm = 34.1168, GNorm = 1.7543, lr_0 = 9.2612e-04
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.914286
Epoch 4
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 5
Loss = 5.9421e-01, PNorm = 34.2077, GNorm = 0.6768, lr_0 = 8.7302e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 6
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 7
Loss = 4.9116e-01, PNorm = 34.3190, GNorm = 0.3547, lr_0 = 8.1813e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 8
Loss = 4.6542e-01, PNorm = 34.4443, GNorm = 2.7324, lr_0 = 7.7122e-04
Loss = 5.3012e-01, PNorm = 34.4571, GNorm = 0.8816, lr_0 = 7.6668e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 9
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 10
Loss = 3.8093e-01, PNorm = 34.5854, GNorm = 1.8676, lr_0 = 7.2273e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 11
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.742857
Epoch 12
Loss = 3.9759e-01, PNorm = 34.7155, GNorm = 0.2841, lr_0 = 6.7728e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 13
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.914286
Epoch 14
Loss = 4.5257e-01, PNorm = 34.8296, GNorm = 3.2999, lr_0 = 6.3469e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 15
Loss = 3.3838e-01, PNorm = 34.9131, GNorm = 1.3036, lr_0 = 5.9831e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 16
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 17
Loss = 2.6986e-01, PNorm = 35.0008, GNorm = 0.5757, lr_0 = 5.6068e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 18
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.828571
Epoch 19
Loss = 2.4667e-01, PNorm = 35.0715, GNorm = 0.3421, lr_0 = 5.2854e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 20
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 21
Loss = 2.1858e-01, PNorm = 35.1365, GNorm = 0.5158, lr_0 = 4.9530e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.828571
Epoch 22
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 23
Loss = 1.9363e-01, PNorm = 35.1976, GNorm = 2.9980, lr_0 = 4.6416e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 24
Loss = 2.1371e-01, PNorm = 35.2415, GNorm = 1.8071, lr_0 = 4.3755e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 25
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 26
Loss = 2.1641e-01, PNorm = 35.2848, GNorm = 1.0000, lr_0 = 4.1003e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 27
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.828571
Epoch 28
Loss = 1.7276e-01, PNorm = 35.3263, GNorm = 1.2403, lr_0 = 3.8425e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 29
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 30
Loss = 2.6696e-01, PNorm = 35.3597, GNorm = 1.9767, lr_0 = 3.6222e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 31
Loss = 2.0024e-01, PNorm = 35.3957, GNorm = 2.8618, lr_0 = 3.3944e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.742857
Epoch 32
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 33
Loss = 1.9960e-01, PNorm = 35.4249, GNorm = 0.5653, lr_0 = 3.1998e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.742857
Epoch 34
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 35
Loss = 1.5836e-01, PNorm = 35.4574, GNorm = 1.6686, lr_0 = 2.9986e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 36
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 37
Loss = 1.5235e-01, PNorm = 35.4858, GNorm = 0.7293, lr_0 = 2.8101e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 38
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 39
Loss = 9.8647e-02, PNorm = 35.5131, GNorm = 1.1008, lr_0 = 2.6334e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 40
Loss = 1.7850e-01, PNorm = 35.5333, GNorm = 2.3092, lr_0 = 2.4824e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 41
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 42
Loss = 1.9209e-01, PNorm = 35.5561, GNorm = 0.3768, lr_0 = 2.3263e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 43
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 44
Loss = 1.2828e-01, PNorm = 35.5746, GNorm = 0.4801, lr_0 = 2.1929e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 45
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 46
Loss = 1.6909e-01, PNorm = 35.5934, GNorm = 2.5237, lr_0 = 2.0550e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 47
Loss = 1.6122e-01, PNorm = 35.6101, GNorm = 2.1162, lr_0 = 1.9372e-04
Loss = 2.0601e-01, PNorm = 35.6114, GNorm = 3.1514, lr_0 = 1.9258e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 48
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 49
Loss = 1.5874e-01, PNorm = 35.6248, GNorm = 1.7930, lr_0 = 1.8154e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 50
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 51
Loss = 1.4455e-01, PNorm = 35.6410, GNorm = 1.2124, lr_0 = 1.7013e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 52
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 53
Loss = 1.4761e-01, PNorm = 35.6553, GNorm = 0.9945, lr_0 = 1.5943e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 54
Loss = 1.5301e-01, PNorm = 35.6683, GNorm = 1.9558, lr_0 = 1.5029e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 55
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 56
Loss = 1.6840e-01, PNorm = 35.6816, GNorm = 0.6938, lr_0 = 1.4084e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 57
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 58
Loss = 8.9127e-02, PNorm = 35.6929, GNorm = 1.4159, lr_0 = 1.3276e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 59
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 60
Loss = 2.1484e-01, PNorm = 35.7031, GNorm = 1.7108, lr_0 = 1.2441e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 61
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 62
Loss = 6.4061e-02, PNorm = 35.7142, GNorm = 0.8267, lr_0 = 1.1659e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 63
Loss = 1.4961e-01, PNorm = 35.7215, GNorm = 2.0353, lr_0 = 1.0991e-04
Loss = 8.0117e-02, PNorm = 35.7223, GNorm = 0.4069, lr_0 = 1.0926e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 64
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 65
Loss = 1.3870e-01, PNorm = 35.7305, GNorm = 0.5422, lr_0 = 1.0300e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 66
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 67
Loss = 1.5853e-01, PNorm = 35.7386, GNorm = 5.4810, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 68
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 69
Loss = 1.7427e-01, PNorm = 35.7470, GNorm = 0.9419, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 70
Loss = 1.4988e-01, PNorm = 35.7544, GNorm = 0.6698, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 71
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 72
Loss = 1.6632e-01, PNorm = 35.7620, GNorm = 3.6462, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 73
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 74
Loss = 9.9485e-02, PNorm = 35.7702, GNorm = 1.2073, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 75
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 76
Loss = 1.5345e-01, PNorm = 35.7780, GNorm = 1.6596, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 77
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 78
Loss = 1.3712e-01, PNorm = 35.7859, GNorm = 1.5974, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 79
Loss = 1.6367e-01, PNorm = 35.7922, GNorm = 6.8444, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Model 0 best validation auc = 1.000000 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.734375
Model 0 test prc-auc = 0.218056
Model 0 test accuracy = 0.888889
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 1
Loss = 6.4256e-01, PNorm = 34.0170, GNorm = 0.5352, lr_0 = 9.8826e-04
Validation auc = 0.281250
Validation prc-auc = 0.057692
Validation accuracy = 0.914286
Epoch 2
Validation auc = 0.468750
Validation prc-auc = 0.075000
Validation accuracy = 0.914286
Epoch 3
Loss = 6.4504e-01, PNorm = 34.0751, GNorm = 0.4063, lr_0 = 9.2612e-04
Validation auc = 0.281250
Validation prc-auc = 0.057692
Validation accuracy = 0.914286
Epoch 4
Validation auc = 0.468750
Validation prc-auc = 0.075000
Validation accuracy = 0.914286
Epoch 5
Loss = 6.1263e-01, PNorm = 34.1433, GNorm = 0.4488, lr_0 = 8.7302e-04
Validation auc = 0.562500
Validation prc-auc = 0.088235
Validation accuracy = 0.914286
Epoch 6
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 7
Loss = 6.1229e-01, PNorm = 34.2413, GNorm = 0.8522, lr_0 = 8.1813e-04
Validation auc = 0.656250
Validation prc-auc = 0.107143
Validation accuracy = 0.771429
Epoch 8
Loss = 5.4700e-01, PNorm = 34.3383, GNorm = 1.9182, lr_0 = 7.7122e-04
Loss = 4.7244e-01, PNorm = 34.3484, GNorm = 0.6569, lr_0 = 7.6668e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 9
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 10
Loss = 5.4710e-01, PNorm = 34.4507, GNorm = 0.7506, lr_0 = 7.2273e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 11
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 12
Loss = 4.8982e-01, PNorm = 34.5680, GNorm = 1.2296, lr_0 = 6.7728e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 13
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 14
Loss = 4.1067e-01, PNorm = 34.6935, GNorm = 2.3488, lr_0 = 6.3469e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 15
Loss = 4.0304e-01, PNorm = 34.7872, GNorm = 1.6541, lr_0 = 5.9831e-04
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.914286
Epoch 16
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 17
Loss = 3.6573e-01, PNorm = 34.8819, GNorm = 0.9303, lr_0 = 5.6068e-04
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.914286
Epoch 18
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 19
Loss = 3.2239e-01, PNorm = 34.9682, GNorm = 1.1076, lr_0 = 5.2854e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 20
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 21
Loss = 3.2076e-01, PNorm = 35.0550, GNorm = 1.2142, lr_0 = 4.9530e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 22
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 23
Loss = 2.4003e-01, PNorm = 35.1244, GNorm = 0.3637, lr_0 = 4.6416e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 24
Loss = 2.2255e-01, PNorm = 35.1823, GNorm = 4.0126, lr_0 = 4.3755e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 25
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 26
Loss = 2.0944e-01, PNorm = 35.2372, GNorm = 2.0979, lr_0 = 4.1003e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 27
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 28
Loss = 1.9608e-01, PNorm = 35.2915, GNorm = 3.2455, lr_0 = 3.8425e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 29
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 30
Loss = 1.5230e-01, PNorm = 35.3329, GNorm = 1.4702, lr_0 = 3.6222e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 31
Loss = 2.0780e-01, PNorm = 35.3712, GNorm = 0.8135, lr_0 = 3.3944e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 32
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 33
Loss = 2.2647e-01, PNorm = 35.4046, GNorm = 0.3758, lr_0 = 3.1998e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 34
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 35
Loss = 2.1956e-01, PNorm = 35.4364, GNorm = 2.1458, lr_0 = 2.9986e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 36
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 37
Loss = 1.7647e-01, PNorm = 35.4645, GNorm = 1.3230, lr_0 = 2.8101e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 38
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 39
Loss = 1.5101e-01, PNorm = 35.4907, GNorm = 2.0576, lr_0 = 2.6334e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 40
Loss = 1.7368e-01, PNorm = 35.5125, GNorm = 2.9056, lr_0 = 2.4824e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 41
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 42
Loss = 1.8046e-01, PNorm = 35.5348, GNorm = 4.5480, lr_0 = 2.3263e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 43
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 44
Loss = 2.1050e-01, PNorm = 35.5538, GNorm = 2.3302, lr_0 = 2.1929e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 45
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 46
Loss = 1.0891e-01, PNorm = 35.5743, GNorm = 2.2069, lr_0 = 2.0550e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 47
Loss = 1.7306e-01, PNorm = 35.5908, GNorm = 3.8175, lr_0 = 1.9372e-04
Loss = 1.7595e-01, PNorm = 35.5924, GNorm = 3.2718, lr_0 = 1.9258e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 48
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 49
Loss = 1.9002e-01, PNorm = 35.6076, GNorm = 1.6507, lr_0 = 1.8154e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 50
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 51
Loss = 1.6784e-01, PNorm = 35.6213, GNorm = 1.3946, lr_0 = 1.7013e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 52
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 53
Loss = 1.5122e-01, PNorm = 35.6356, GNorm = 1.0634, lr_0 = 1.5943e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 54
Loss = 1.7198e-01, PNorm = 35.6475, GNorm = 4.9103, lr_0 = 1.5029e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 55
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 56
Loss = 1.5766e-01, PNorm = 35.6583, GNorm = 1.5573, lr_0 = 1.4084e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 57
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 58
Loss = 1.3267e-01, PNorm = 35.6684, GNorm = 1.4367, lr_0 = 1.3276e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 59
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 60
Loss = 1.7663e-01, PNorm = 35.6787, GNorm = 1.9352, lr_0 = 1.2441e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 61
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 62
Loss = 9.5338e-02, PNorm = 35.6880, GNorm = 0.9511, lr_0 = 1.1659e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 63
Loss = 1.4793e-01, PNorm = 35.6965, GNorm = 0.6157, lr_0 = 1.0991e-04
Loss = 1.6840e-01, PNorm = 35.6974, GNorm = 2.4561, lr_0 = 1.0926e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 64
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 65
Loss = 1.3385e-01, PNorm = 35.7052, GNorm = 1.1694, lr_0 = 1.0300e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 66
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 67
Loss = 1.5256e-01, PNorm = 35.7133, GNorm = 1.5893, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 68
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 69
Loss = 8.1759e-02, PNorm = 35.7205, GNorm = 1.4366, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 70
Loss = 1.3942e-01, PNorm = 35.7279, GNorm = 1.1736, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 71
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 72
Loss = 1.4613e-01, PNorm = 35.7353, GNorm = 2.2116, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 73
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 74
Loss = 1.3372e-01, PNorm = 35.7434, GNorm = 1.4907, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 75
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 76
Loss = 1.8827e-01, PNorm = 35.7511, GNorm = 1.9257, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 77
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 78
Loss = 1.6928e-01, PNorm = 35.7593, GNorm = 1.5311, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 79
Loss = 1.4611e-01, PNorm = 35.7662, GNorm = 2.8331, lr_0 = 1.0000e-04
Validation auc = 0.625000
Validation prc-auc = 0.100000
Validation accuracy = 0.914286
Model 1 best validation auc = 1.000000 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.734375
Model 1 test prc-auc = 0.218056
Model 1 test accuracy = 0.888889
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.281250
Validation prc-auc = 0.057692
Validation accuracy = 0.914286
Epoch 1
Loss = 6.4690e-01, PNorm = 34.0287, GNorm = 0.4257, lr_0 = 9.8826e-04
Validation auc = 0.468750
Validation prc-auc = 0.075000
Validation accuracy = 0.914286
Epoch 2
Validation auc = 0.375000
Validation prc-auc = 0.065217
Validation accuracy = 0.914286
Epoch 3
Loss = 5.8399e-01, PNorm = 34.0906, GNorm = 1.1187, lr_0 = 9.2612e-04
Validation auc = 0.468750
Validation prc-auc = 0.075000
Validation accuracy = 0.428571
Epoch 4
Validation auc = 0.843750
Validation prc-auc = 0.187500
Validation accuracy = 0.914286
Epoch 5
Loss = 5.0416e-01, PNorm = 34.1499, GNorm = 0.5979, lr_0 = 8.7302e-04
Validation auc = 0.468750
Validation prc-auc = 0.075000
Validation accuracy = 0.914286
Epoch 6
Validation auc = 0.843750
Validation prc-auc = 0.187500
Validation accuracy = 0.914286
Epoch 7
Loss = 5.6609e-01, PNorm = 34.2265, GNorm = 0.3713, lr_0 = 8.1813e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 8
Loss = 5.6676e-01, PNorm = 34.3151, GNorm = 1.0904, lr_0 = 7.7122e-04
Loss = 5.7819e-01, PNorm = 34.3236, GNorm = 1.2424, lr_0 = 7.6668e-04
Validation auc = 0.843750
Validation prc-auc = 0.187500
Validation accuracy = 0.914286
Epoch 9
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 10
Loss = 5.4021e-01, PNorm = 34.4166, GNorm = 1.5345, lr_0 = 7.2273e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 11
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 12
Loss = 5.2828e-01, PNorm = 34.5314, GNorm = 1.7821, lr_0 = 6.7728e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 13
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 14
Loss = 4.3165e-01, PNorm = 34.6538, GNorm = 1.0523, lr_0 = 6.3469e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 15
Loss = 4.1210e-01, PNorm = 34.7504, GNorm = 1.1252, lr_0 = 5.9831e-04
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 16
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 17
Loss = 4.0213e-01, PNorm = 34.8590, GNorm = 2.3772, lr_0 = 5.6068e-04
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.828571
Epoch 18
Validation auc = 1.000000
Validation prc-auc = 1.000000
Validation accuracy = 0.914286
Epoch 19
Loss = 3.5263e-01, PNorm = 34.9539, GNorm = 0.8347, lr_0 = 5.2854e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 20
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 21
Loss = 2.9317e-01, PNorm = 35.0544, GNorm = 0.7840, lr_0 = 4.9530e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 22
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 23
Loss = 2.7405e-01, PNorm = 35.1540, GNorm = 1.1415, lr_0 = 4.6416e-04
Validation auc = 0.812500
Validation prc-auc = 0.166667
Validation accuracy = 0.914286
Epoch 24
Loss = 2.4555e-01, PNorm = 35.2335, GNorm = 1.0230, lr_0 = 4.3755e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.742857
Epoch 25
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.914286
Epoch 26
Loss = 2.9744e-01, PNorm = 35.3044, GNorm = 2.5345, lr_0 = 4.1003e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 27
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 28
Loss = 2.3366e-01, PNorm = 35.3657, GNorm = 1.7543, lr_0 = 3.8425e-04
Validation auc = 0.906250
Validation prc-auc = 0.250000
Validation accuracy = 0.914286
Epoch 29
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 30
Loss = 2.7201e-01, PNorm = 35.4142, GNorm = 1.1060, lr_0 = 3.6222e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 31
Loss = 2.4732e-01, PNorm = 35.4604, GNorm = 0.5823, lr_0 = 3.3944e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 32
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 33
Loss = 1.9391e-01, PNorm = 35.5003, GNorm = 0.7844, lr_0 = 3.1998e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 34
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 35
Loss = 2.4162e-01, PNorm = 35.5373, GNorm = 2.1248, lr_0 = 2.9986e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 36
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 37
Loss = 1.6787e-01, PNorm = 35.5683, GNorm = 0.9791, lr_0 = 2.8101e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 38
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 39
Loss = 2.7746e-01, PNorm = 35.5965, GNorm = 1.0814, lr_0 = 2.6334e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 40
Loss = 2.1202e-01, PNorm = 35.6252, GNorm = 2.5145, lr_0 = 2.4824e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 41
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 42
Loss = 1.8736e-01, PNorm = 35.6503, GNorm = 0.4048, lr_0 = 2.3263e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 43
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 44
Loss = 2.0343e-01, PNorm = 35.6733, GNorm = 0.9117, lr_0 = 2.1929e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 45
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 46
Loss = 1.6041e-01, PNorm = 35.6959, GNorm = 0.5447, lr_0 = 2.0550e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 47
Loss = 1.7557e-01, PNorm = 35.7152, GNorm = 1.3048, lr_0 = 1.9372e-04
Loss = 1.9888e-01, PNorm = 35.7171, GNorm = 0.6361, lr_0 = 1.9258e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 48
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 49
Loss = 1.5954e-01, PNorm = 35.7352, GNorm = 1.3176, lr_0 = 1.8154e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 50
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 51
Loss = 1.7042e-01, PNorm = 35.7550, GNorm = 2.1263, lr_0 = 1.7013e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 52
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 53
Loss = 7.9655e-02, PNorm = 35.7737, GNorm = 0.9026, lr_0 = 1.5943e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 54
Loss = 1.7550e-01, PNorm = 35.7879, GNorm = 0.6697, lr_0 = 1.5029e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 55
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 56
Loss = 1.6953e-01, PNorm = 35.8047, GNorm = 0.6298, lr_0 = 1.4084e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 57
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 58
Loss = 1.6125e-01, PNorm = 35.8181, GNorm = 0.2679, lr_0 = 1.3276e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 59
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 60
Loss = 1.6013e-01, PNorm = 35.8311, GNorm = 1.2225, lr_0 = 1.2441e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 61
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 62
Loss = 2.4156e-01, PNorm = 35.8441, GNorm = 1.6124, lr_0 = 1.1659e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 63
Loss = 1.6558e-01, PNorm = 35.8551, GNorm = 1.3760, lr_0 = 1.0991e-04
Loss = 8.2663e-02, PNorm = 35.8562, GNorm = 0.3983, lr_0 = 1.0926e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 64
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 65
Loss = 1.6673e-01, PNorm = 35.8663, GNorm = 0.6861, lr_0 = 1.0300e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 66
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 67
Loss = 1.2784e-01, PNorm = 35.8775, GNorm = 1.0893, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 68
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 69
Loss = 2.1867e-01, PNorm = 35.8855, GNorm = 1.2650, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 70
Loss = 1.4858e-01, PNorm = 35.8961, GNorm = 1.0664, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 71
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 72
Loss = 1.3844e-01, PNorm = 35.9058, GNorm = 2.3970, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 73
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 74
Loss = 1.7394e-01, PNorm = 35.9150, GNorm = 1.6169, lr_0 = 1.0000e-04
Validation auc = 0.625000
Validation prc-auc = 0.100000
Validation accuracy = 0.914286
Epoch 75
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 76
Loss = 1.9763e-01, PNorm = 35.9248, GNorm = 1.7020, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.914286
Epoch 77
Validation auc = 0.625000
Validation prc-auc = 0.100000
Validation accuracy = 0.914286
Epoch 78
Loss = 2.4894e-01, PNorm = 35.9347, GNorm = 1.3518, lr_0 = 1.0000e-04
Validation auc = 0.718750
Validation prc-auc = 0.125000
Validation accuracy = 0.828571
Epoch 79
Loss = 1.4364e-01, PNorm = 35.9433, GNorm = 1.0304, lr_0 = 1.0000e-04
Validation auc = 0.625000
Validation prc-auc = 0.100000
Validation accuracy = 0.914286
Model 2 best validation auc = 1.000000 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.734375
Model 2 test prc-auc = 0.218056
Model 2 test accuracy = 0.888889
Ensemble test auc = 0.734375
Ensemble test prc-auc = 0.218056
Ensemble test accuracy = 0.888889
Fold 1
Splitting data with seed 1
Total scaffolds = 65 | train scaffolds = 47 | val scaffolds = 9 | test scaffolds = 9
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 33 | target average = 1.000000


Scaffold 1
Task 0: count = 24 | target average = 0.041667


Scaffold 2
Task 0: count = 21 | target average = 1.000000


Scaffold 3
Task 0: count = 21 | target average = 0.000000


Scaffold 4
Task 0: count = 14 | target average = 0.000000


Scaffold 5
Task 0: count = 12 | target average = 0.083333


Scaffold 6
Task 0: count = 9 | target average = 0.000000


Scaffold 7
Task 0: count = 7 | target average = 1.000000


Scaffold 8
Task 0: count = 6 | target average = 0.833333


Scaffold 9
Task 0: count = 6 | target average = 0.500000


Class sizes
bin_activity 0: 69.12%, 1: 30.88%
Total size = 353 | train size = 280 | val size = 34 | test size = 39
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 1
Loss = 6.2384e-01, PNorm = 34.0266, GNorm = 0.1829, lr_0 = 9.8826e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 2
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 3
Loss = 5.9090e-01, PNorm = 34.1005, GNorm = 1.2732, lr_0 = 9.2612e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 4
Validation auc = 0.908654
Validation prc-auc = 0.910357
Validation accuracy = 0.764706
Epoch 5
Loss = 5.9749e-01, PNorm = 34.1975, GNorm = 1.1389, lr_0 = 8.7302e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.764706
Epoch 6
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.882353
Epoch 7
Loss = 5.2924e-01, PNorm = 34.3125, GNorm = 0.8935, lr_0 = 8.1813e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 8
Loss = 4.7094e-01, PNorm = 34.4533, GNorm = 0.5047, lr_0 = 7.6668e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 9
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 10
Loss = 4.2058e-01, PNorm = 34.5888, GNorm = 3.6491, lr_0 = 7.2273e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 11
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.794118
Epoch 12
Loss = 3.8829e-01, PNorm = 34.7158, GNorm = 1.2938, lr_0 = 6.7728e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 13
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 14
Loss = 4.8689e-01, PNorm = 34.8453, GNorm = 2.8461, lr_0 = 6.3469e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.794118
Epoch 15
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 16
Loss = 2.1137e-01, PNorm = 34.9724, GNorm = 0.6464, lr_0 = 5.9478e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 17
Loss = 2.9442e-01, PNorm = 35.0785, GNorm = 0.8730, lr_0 = 5.6068e-04
Loss = 1.3895e-01, PNorm = 35.0891, GNorm = 0.7398, lr_0 = 5.5738e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 18
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 19
Loss = 2.6210e-01, PNorm = 35.1852, GNorm = 2.1188, lr_0 = 5.2543e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 20
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 21
Loss = 2.5141e-01, PNorm = 35.2671, GNorm = 3.2762, lr_0 = 4.9239e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 22
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 23
Loss = 2.5294e-01, PNorm = 35.3430, GNorm = 1.7745, lr_0 = 4.6143e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 24
Loss = 1.9464e-01, PNorm = 35.4075, GNorm = 1.7573, lr_0 = 4.3497e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 25
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 26
Loss = 2.0009e-01, PNorm = 35.4722, GNorm = 2.5428, lr_0 = 4.0762e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 27
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 28
Loss = 2.0179e-01, PNorm = 35.5293, GNorm = 2.8256, lr_0 = 3.8199e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 29
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 30
Loss = 1.9925e-01, PNorm = 35.5724, GNorm = 1.6925, lr_0 = 3.6009e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 31
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 32
Loss = 1.6832e-01, PNorm = 35.6174, GNorm = 1.2324, lr_0 = 3.3745e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 33
Loss = 1.9290e-01, PNorm = 35.6575, GNorm = 3.1230, lr_0 = 3.1623e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 34
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 35
Loss = 1.4912e-01, PNorm = 35.6901, GNorm = 2.1434, lr_0 = 2.9810e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 36
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 37
Loss = 1.6105e-01, PNorm = 35.7229, GNorm = 1.6774, lr_0 = 2.7935e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 38
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 39
Loss = 1.9011e-01, PNorm = 35.7524, GNorm = 0.6775, lr_0 = 2.6179e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 40
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 41
Loss = 1.3305e-01, PNorm = 35.7796, GNorm = 2.0065, lr_0 = 2.4533e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 42
Loss = 1.4839e-01, PNorm = 35.8024, GNorm = 1.8711, lr_0 = 2.3126e-04
Loss = 8.0611e-02, PNorm = 35.8046, GNorm = 0.6114, lr_0 = 2.2990e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 43
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 44
Loss = 1.3363e-01, PNorm = 35.8246, GNorm = 1.5077, lr_0 = 2.1672e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 45
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 46
Loss = 1.0882e-01, PNorm = 35.8467, GNorm = 3.7193, lr_0 = 2.0309e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 47
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 48
Loss = 1.1843e-01, PNorm = 35.8659, GNorm = 0.8812, lr_0 = 1.9032e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 49
Loss = 1.2017e-01, PNorm = 35.8825, GNorm = 1.1520, lr_0 = 1.7941e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 50
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 51
Loss = 1.2516e-01, PNorm = 35.8994, GNorm = 0.8599, lr_0 = 1.6813e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 52
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 53
Loss = 1.2385e-01, PNorm = 35.9147, GNorm = 0.6718, lr_0 = 1.5756e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 54
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 55
Loss = 8.6304e-02, PNorm = 35.9282, GNorm = 1.0569, lr_0 = 1.4852e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 56
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 57
Loss = 9.2667e-02, PNorm = 35.9421, GNorm = 1.6445, lr_0 = 1.3918e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 58
Loss = 1.1976e-01, PNorm = 35.9544, GNorm = 1.0778, lr_0 = 1.3043e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 59
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 60
Loss = 1.1348e-01, PNorm = 35.9655, GNorm = 3.3591, lr_0 = 1.2295e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 61
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 62
Loss = 1.0986e-01, PNorm = 35.9769, GNorm = 0.8014, lr_0 = 1.1522e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 63
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 64
Loss = 1.1092e-01, PNorm = 35.9866, GNorm = 1.7211, lr_0 = 1.0798e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 65
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 66
Loss = 8.4180e-02, PNorm = 35.9963, GNorm = 1.6862, lr_0 = 1.0119e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 67
Loss = 1.2114e-01, PNorm = 36.0044, GNorm = 2.2153, lr_0 = 1.0000e-04
Loss = 1.7974e-01, PNorm = 36.0050, GNorm = 4.9009, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 68
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 69
Loss = 1.0675e-01, PNorm = 36.0130, GNorm = 0.9121, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 70
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 71
Loss = 9.7142e-02, PNorm = 36.0213, GNorm = 0.7453, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 72
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 73
Loss = 1.1761e-01, PNorm = 36.0297, GNorm = 3.8986, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 74
Loss = 1.0707e-01, PNorm = 36.0377, GNorm = 2.9462, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 75
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 76
Loss = 1.1786e-01, PNorm = 36.0454, GNorm = 1.6340, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 77
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 78
Loss = 1.3062e-01, PNorm = 36.0537, GNorm = 3.5143, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 79
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Model 0 best validation auc = 0.908654 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.700893
Model 0 test prc-auc = 0.271154
Model 0 test accuracy = 0.820513
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 1
Loss = 6.8304e-01, PNorm = 34.0152, GNorm = 0.8478, lr_0 = 9.8826e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 2
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 3
Loss = 6.0180e-01, PNorm = 34.0695, GNorm = 0.2608, lr_0 = 9.2612e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 4
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 5
Loss = 6.6451e-01, PNorm = 34.1292, GNorm = 1.0741, lr_0 = 8.7302e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 6
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 7
Loss = 5.4617e-01, PNorm = 34.2081, GNorm = 0.3875, lr_0 = 8.1813e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 8
Loss = 5.5206e-01, PNorm = 34.3211, GNorm = 0.2840, lr_0 = 7.6668e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 9
Validation auc = 0.908654
Validation prc-auc = 0.910357
Validation accuracy = 0.970588
Epoch 10
Loss = 4.9227e-01, PNorm = 34.4378, GNorm = 0.8794, lr_0 = 7.2273e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 11
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 12
Loss = 5.2317e-01, PNorm = 34.5572, GNorm = 2.9218, lr_0 = 6.7728e-04
Validation auc = 0.908654
Validation prc-auc = 0.910357
Validation accuracy = 0.764706
Epoch 13
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.882353
Epoch 14
Loss = 4.7716e-01, PNorm = 34.6645, GNorm = 2.5915, lr_0 = 6.3469e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 15
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 16
Loss = 3.5902e-01, PNorm = 34.7735, GNorm = 1.7611, lr_0 = 5.9478e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 17
Loss = 3.5461e-01, PNorm = 34.8781, GNorm = 1.6398, lr_0 = 5.6068e-04
Loss = 5.0328e-01, PNorm = 34.8862, GNorm = 2.4982, lr_0 = 5.5738e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 18
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 19
Loss = 3.4903e-01, PNorm = 34.9668, GNorm = 4.8043, lr_0 = 5.2543e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.794118
Epoch 20
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 21
Loss = 3.3404e-01, PNorm = 35.0442, GNorm = 6.5118, lr_0 = 4.9239e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.764706
Epoch 22
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.617647
Epoch 23
Loss = 3.9103e-01, PNorm = 35.1093, GNorm = 3.5970, lr_0 = 4.6143e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 24
Loss = 3.0380e-01, PNorm = 35.1725, GNorm = 3.2107, lr_0 = 4.3497e-04
Validation auc = 0.908654
Validation prc-auc = 0.910357
Validation accuracy = 0.882353
Epoch 25
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 26
Loss = 2.7193e-01, PNorm = 35.2383, GNorm = 0.6417, lr_0 = 4.0762e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.705882
Epoch 27
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 28
Loss = 2.5313e-01, PNorm = 35.2912, GNorm = 0.4248, lr_0 = 3.8199e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 29
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 30
Loss = 2.0202e-01, PNorm = 35.3393, GNorm = 2.2200, lr_0 = 3.6009e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 31
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 32
Loss = 1.9661e-01, PNorm = 35.3835, GNorm = 2.2020, lr_0 = 3.3745e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 33
Loss = 2.0483e-01, PNorm = 35.4246, GNorm = 1.7905, lr_0 = 3.1623e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 34
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 35
Loss = 1.6448e-01, PNorm = 35.4585, GNorm = 0.6639, lr_0 = 2.9810e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 36
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 37
Loss = 2.3808e-01, PNorm = 35.4938, GNorm = 1.2271, lr_0 = 2.7935e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 38
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 39
Loss = 1.3335e-01, PNorm = 35.5284, GNorm = 0.6621, lr_0 = 2.6179e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 40
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 41
Loss = 1.3154e-01, PNorm = 35.5589, GNorm = 1.2381, lr_0 = 2.4533e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 42
Loss = 1.7394e-01, PNorm = 35.5844, GNorm = 2.4327, lr_0 = 2.3126e-04
Loss = 1.0429e-01, PNorm = 35.5870, GNorm = 0.8874, lr_0 = 2.2990e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 43
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 44
Loss = 1.6412e-01, PNorm = 35.6116, GNorm = 3.7256, lr_0 = 2.1672e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.794118
Epoch 45
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 46
Loss = 1.3512e-01, PNorm = 35.6353, GNorm = 2.3553, lr_0 = 2.0309e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 47
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 48
Loss = 8.6200e-02, PNorm = 35.6563, GNorm = 0.5464, lr_0 = 1.9032e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 49
Loss = 1.4774e-01, PNorm = 35.6746, GNorm = 2.1064, lr_0 = 1.7941e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 50
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 51
Loss = 1.5977e-01, PNorm = 35.6921, GNorm = 1.8740, lr_0 = 1.6813e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 52
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 53
Loss = 1.4161e-01, PNorm = 35.7083, GNorm = 1.3639, lr_0 = 1.5756e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 54
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 55
Loss = 1.1010e-01, PNorm = 35.7212, GNorm = 1.8956, lr_0 = 1.4852e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 56
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 57
Loss = 1.3001e-01, PNorm = 35.7354, GNorm = 1.5471, lr_0 = 1.3918e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 58
Loss = 1.3416e-01, PNorm = 35.7474, GNorm = 0.7305, lr_0 = 1.3043e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 59
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 60
Loss = 1.2863e-01, PNorm = 35.7591, GNorm = 0.6304, lr_0 = 1.2295e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 61
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 62
Loss = 1.0196e-01, PNorm = 35.7696, GNorm = 0.7367, lr_0 = 1.1522e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 63
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 64
Loss = 1.0004e-01, PNorm = 35.7800, GNorm = 0.6213, lr_0 = 1.0798e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 65
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 66
Loss = 1.8951e-01, PNorm = 35.7888, GNorm = 0.8620, lr_0 = 1.0119e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 67
Loss = 1.1089e-01, PNorm = 35.7969, GNorm = 0.5893, lr_0 = 1.0000e-04
Loss = 2.4269e-01, PNorm = 35.7976, GNorm = 4.6214, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 68
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 69
Loss = 1.3458e-01, PNorm = 35.8056, GNorm = 1.5763, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 70
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 71
Loss = 1.4870e-01, PNorm = 35.8139, GNorm = 1.6346, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 72
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 73
Loss = 1.4853e-01, PNorm = 35.8234, GNorm = 2.0757, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 74
Loss = 1.2036e-01, PNorm = 35.8320, GNorm = 1.7980, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 75
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 76
Loss = 1.2520e-01, PNorm = 35.8404, GNorm = 1.3068, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.882353
Epoch 77
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 78
Loss = 1.1046e-01, PNorm = 35.8490, GNorm = 1.7460, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.794118
Epoch 79
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Model 1 best validation auc = 0.908654 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.754464
Model 1 test prc-auc = 0.594733
Model 1 test accuracy = 0.820513
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.923077
Validation prc-auc = 0.914886
Validation accuracy = 0.764706
Epoch 1
Loss = 6.3888e-01, PNorm = 34.0239, GNorm = 0.3877, lr_0 = 9.8826e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 2
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.764706
Epoch 3
Loss = 5.9162e-01, PNorm = 34.0845, GNorm = 0.2025, lr_0 = 9.2612e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 4
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 5
Loss = 5.6461e-01, PNorm = 34.1657, GNorm = 0.7375, lr_0 = 8.7302e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 6
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.882353
Epoch 7
Loss = 5.2149e-01, PNorm = 34.2793, GNorm = 0.2796, lr_0 = 8.1813e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.970588
Epoch 8
Loss = 4.7053e-01, PNorm = 34.4000, GNorm = 1.9052, lr_0 = 7.6668e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.882353
Epoch 9
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.794118
Epoch 10
Loss = 4.2832e-01, PNorm = 34.5183, GNorm = 1.6302, lr_0 = 7.2273e-04
Validation auc = 0.879808
Validation prc-auc = 0.903819
Validation accuracy = 0.705882
Epoch 11
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 12
Loss = 3.8936e-01, PNorm = 34.6453, GNorm = 1.0960, lr_0 = 6.7728e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 13
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 14
Loss = 4.6673e-01, PNorm = 34.7539, GNorm = 1.8210, lr_0 = 6.3469e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 15
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.705882
Epoch 16
Loss = 3.0705e-01, PNorm = 34.8522, GNorm = 5.0418, lr_0 = 5.9478e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.617647
Epoch 17
Loss = 3.1481e-01, PNorm = 34.9353, GNorm = 1.9480, lr_0 = 5.6068e-04
Loss = 3.4360e-01, PNorm = 34.9426, GNorm = 2.6460, lr_0 = 5.5738e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 18
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 19
Loss = 2.9140e-01, PNorm = 35.0159, GNorm = 1.2363, lr_0 = 5.2543e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 20
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 21
Loss = 2.1374e-01, PNorm = 35.0911, GNorm = 4.1614, lr_0 = 4.9239e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 22
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 23
Loss = 3.0734e-01, PNorm = 35.1581, GNorm = 3.1873, lr_0 = 4.6143e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 24
Loss = 2.1944e-01, PNorm = 35.2191, GNorm = 1.1231, lr_0 = 4.3497e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 25
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 26
Loss = 2.0910e-01, PNorm = 35.2815, GNorm = 0.9146, lr_0 = 4.0762e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 27
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.794118
Epoch 28
Loss = 2.6705e-01, PNorm = 35.3313, GNorm = 3.2208, lr_0 = 3.8199e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 29
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 30
Loss = 2.0508e-01, PNorm = 35.3730, GNorm = 0.6465, lr_0 = 3.6009e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 31
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 32
Loss = 1.8896e-01, PNorm = 35.4166, GNorm = 1.6479, lr_0 = 3.3745e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 33
Loss = 1.8762e-01, PNorm = 35.4572, GNorm = 2.7794, lr_0 = 3.1623e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 34
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 35
Loss = 1.6670e-01, PNorm = 35.4899, GNorm = 3.4253, lr_0 = 2.9810e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 36
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 37
Loss = 1.7149e-01, PNorm = 35.5221, GNorm = 4.1693, lr_0 = 2.7935e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 38
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 39
Loss = 1.7830e-01, PNorm = 35.5526, GNorm = 3.0353, lr_0 = 2.6179e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 40
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 41
Loss = 1.4616e-01, PNorm = 35.5824, GNorm = 0.8729, lr_0 = 2.4533e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 42
Loss = 1.6489e-01, PNorm = 35.6059, GNorm = 1.2145, lr_0 = 2.3126e-04
Loss = 1.7495e-01, PNorm = 35.6086, GNorm = 1.1764, lr_0 = 2.2990e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 43
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 44
Loss = 1.8117e-01, PNorm = 35.6307, GNorm = 2.5910, lr_0 = 2.1672e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 45
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 46
Loss = 1.6243e-01, PNorm = 35.6553, GNorm = 7.2518, lr_0 = 2.0309e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 47
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 48
Loss = 1.8599e-01, PNorm = 35.6753, GNorm = 4.9923, lr_0 = 1.9032e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 49
Loss = 1.4495e-01, PNorm = 35.6933, GNorm = 3.5146, lr_0 = 1.7941e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 50
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 51
Loss = 1.7712e-01, PNorm = 35.7108, GNorm = 0.9281, lr_0 = 1.6813e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 52
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 53
Loss = 1.3583e-01, PNorm = 35.7268, GNorm = 1.2095, lr_0 = 1.5756e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 54
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 55
Loss = 1.6763e-01, PNorm = 35.7401, GNorm = 3.8988, lr_0 = 1.4852e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 56
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 57
Loss = 1.6211e-01, PNorm = 35.7546, GNorm = 0.9413, lr_0 = 1.3918e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 58
Loss = 1.2522e-01, PNorm = 35.7672, GNorm = 0.5301, lr_0 = 1.3043e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 59
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 60
Loss = 1.4020e-01, PNorm = 35.7793, GNorm = 1.8827, lr_0 = 1.2295e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 61
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 62
Loss = 1.4180e-01, PNorm = 35.7900, GNorm = 1.2650, lr_0 = 1.1522e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 63
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 64
Loss = 6.4869e-02, PNorm = 35.8010, GNorm = 1.6034, lr_0 = 1.0798e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 65
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 66
Loss = 1.4350e-01, PNorm = 35.8106, GNorm = 1.8525, lr_0 = 1.0119e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 67
Loss = 1.1902e-01, PNorm = 35.8195, GNorm = 1.6806, lr_0 = 1.0000e-04
Loss = 1.2079e-01, PNorm = 35.8204, GNorm = 1.8678, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 68
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 69
Loss = 1.2570e-01, PNorm = 35.8292, GNorm = 2.7022, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 70
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 71
Loss = 9.6236e-02, PNorm = 35.8385, GNorm = 1.8983, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 72
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 73
Loss = 1.1819e-01, PNorm = 35.8478, GNorm = 1.2915, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 74
Loss = 1.2486e-01, PNorm = 35.8564, GNorm = 5.7129, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 75
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 76
Loss = 1.2920e-01, PNorm = 35.8663, GNorm = 4.9521, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 77
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 78
Loss = 1.1453e-01, PNorm = 35.8753, GNorm = 0.8439, lr_0 = 1.0000e-04
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Epoch 79
Validation auc = 0.894231
Validation prc-auc = 0.906754
Validation accuracy = 0.970588
Model 2 best validation auc = 0.923077 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.352679
Model 2 test prc-auc = 0.135353
Model 2 test accuracy = 0.820513
Ensemble test auc = 0.741071
Ensemble test prc-auc = 0.592582
Ensemble test accuracy = 0.820513
Fold 2
Splitting data with seed 2
Total scaffolds = 65 | train scaffolds = 47 | val scaffolds = 9 | test scaffolds = 9
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 33 | target average = 1.000000


Scaffold 1
Task 0: count = 24 | target average = 0.041667


Scaffold 2
Task 0: count = 21 | target average = 0.000000


Scaffold 3
Task 0: count = 21 | target average = 1.000000


Scaffold 4
Task 0: count = 14 | target average = 0.000000


Scaffold 5
Task 0: count = 12 | target average = 0.083333


Scaffold 6
Task 0: count = 9 | target average = 0.000000


Scaffold 7
Task 0: count = 7 | target average = 1.000000


Scaffold 8
Task 0: count = 6 | target average = 0.000000


Scaffold 9
Task 0: count = 6 | target average = 0.333333


Class sizes
bin_activity 0: 69.12%, 1: 30.88%
Total size = 353 | train size = 280 | val size = 34 | test size = 39
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.936759
Validation prc-auc = 0.945130
Validation accuracy = 0.676471
Epoch 1
Loss = 6.4752e-01, PNorm = 34.0276, GNorm = 0.5715, lr_0 = 9.8826e-04
Validation auc = 0.889328
Validation prc-auc = 0.843283
Validation accuracy = 0.676471
Epoch 2
Validation auc = 0.936759
Validation prc-auc = 0.891438
Validation accuracy = 0.676471
Epoch 3
Loss = 6.0425e-01, PNorm = 34.0934, GNorm = 0.1655, lr_0 = 9.2612e-04
Validation auc = 0.936759
Validation prc-auc = 0.891438
Validation accuracy = 0.676471
Epoch 4
Validation auc = 0.889328
Validation prc-auc = 0.843283
Validation accuracy = 0.676471
Epoch 5
Loss = 5.5279e-01, PNorm = 34.1817, GNorm = 0.2251, lr_0 = 8.7302e-04
Validation auc = 0.830040
Validation prc-auc = 0.827769
Validation accuracy = 0.882353
Epoch 6
Validation auc = 0.830040
Validation prc-auc = 0.827769
Validation accuracy = 0.676471
Epoch 7
Loss = 3.6640e-01, PNorm = 34.3062, GNorm = 0.4429, lr_0 = 8.1813e-04
Validation auc = 0.901186
Validation prc-auc = 0.865311
Validation accuracy = 0.676471
Epoch 8
Loss = 5.4466e-01, PNorm = 34.4189, GNorm = 2.4464, lr_0 = 7.6668e-04
Validation auc = 0.774704
Validation prc-auc = 0.530799
Validation accuracy = 0.676471
Epoch 9
Validation auc = 0.830040
Validation prc-auc = 0.827769
Validation accuracy = 0.852941
Epoch 10
Loss = 4.4220e-01, PNorm = 34.5385, GNorm = 0.5146, lr_0 = 7.2273e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 11
Validation auc = 0.774704
Validation prc-auc = 0.530799
Validation accuracy = 0.852941
Epoch 12
Loss = 3.7978e-01, PNorm = 34.6690, GNorm = 0.3739, lr_0 = 6.7728e-04
Validation auc = 0.774704
Validation prc-auc = 0.530799
Validation accuracy = 0.852941
Epoch 13
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.941176
Epoch 14
Loss = 4.1808e-01, PNorm = 34.8030, GNorm = 1.2675, lr_0 = 6.3469e-04
Validation auc = 0.881423
Validation prc-auc = 0.598878
Validation accuracy = 0.764706
Epoch 15
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 16
Loss = 4.6494e-01, PNorm = 34.9203, GNorm = 4.5884, lr_0 = 5.9478e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.676471
Epoch 17
Loss = 3.1713e-01, PNorm = 35.0088, GNorm = 2.0908, lr_0 = 5.6068e-04
Loss = 3.7753e-01, PNorm = 35.0168, GNorm = 1.3164, lr_0 = 5.5738e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.588235
Epoch 18
Validation auc = 0.881423
Validation prc-auc = 0.598878
Validation accuracy = 0.852941
Epoch 19
Loss = 2.4389e-01, PNorm = 35.0973, GNorm = 0.6059, lr_0 = 5.2543e-04
Validation auc = 0.798419
Validation prc-auc = 0.487107
Validation accuracy = 0.676471
Epoch 20
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 21
Loss = 2.2886e-01, PNorm = 35.1761, GNorm = 0.5008, lr_0 = 4.9239e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 22
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 23
Loss = 2.2032e-01, PNorm = 35.2343, GNorm = 1.2639, lr_0 = 4.6143e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 24
Loss = 2.3378e-01, PNorm = 35.2897, GNorm = 2.1816, lr_0 = 4.3497e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 25
Validation auc = 0.881423
Validation prc-auc = 0.598878
Validation accuracy = 0.764706
Epoch 26
Loss = 2.0247e-01, PNorm = 35.3445, GNorm = 1.4872, lr_0 = 4.0762e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 27
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 28
Loss = 1.7655e-01, PNorm = 35.3956, GNorm = 0.7849, lr_0 = 3.8199e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 29
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 30
Loss = 2.5195e-01, PNorm = 35.4381, GNorm = 2.3429, lr_0 = 3.6009e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 31
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 32
Loss = 2.2472e-01, PNorm = 35.4806, GNorm = 1.1404, lr_0 = 3.3745e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 33
Loss = 1.6813e-01, PNorm = 35.5208, GNorm = 2.3366, lr_0 = 3.1623e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 34
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 35
Loss = 1.9057e-01, PNorm = 35.5551, GNorm = 3.1539, lr_0 = 2.9810e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 36
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 37
Loss = 1.7065e-01, PNorm = 35.5892, GNorm = 1.0540, lr_0 = 2.7935e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 38
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 39
Loss = 1.9770e-01, PNorm = 35.6207, GNorm = 2.5567, lr_0 = 2.6179e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 40
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 41
Loss = 1.8703e-01, PNorm = 35.6450, GNorm = 0.5085, lr_0 = 2.4533e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 42
Loss = 1.2507e-01, PNorm = 35.6663, GNorm = 1.9605, lr_0 = 2.3126e-04
Loss = 3.3757e-01, PNorm = 35.6680, GNorm = 1.5959, lr_0 = 2.2990e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 43
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 44
Loss = 1.8278e-01, PNorm = 35.6870, GNorm = 0.6320, lr_0 = 2.1672e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 45
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 46
Loss = 1.5329e-01, PNorm = 35.7088, GNorm = 3.2718, lr_0 = 2.0309e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 47
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 48
Loss = 1.6630e-01, PNorm = 35.7266, GNorm = 1.3798, lr_0 = 1.9032e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 49
Loss = 1.3646e-01, PNorm = 35.7421, GNorm = 0.8850, lr_0 = 1.7941e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 50
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 51
Loss = 1.4811e-01, PNorm = 35.7578, GNorm = 1.2968, lr_0 = 1.6813e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 52
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 53
Loss = 1.0930e-01, PNorm = 35.7720, GNorm = 2.1564, lr_0 = 1.5756e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 54
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 55
Loss = 1.1325e-01, PNorm = 35.7829, GNorm = 0.8941, lr_0 = 1.4852e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 56
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 57
Loss = 1.6317e-01, PNorm = 35.7931, GNorm = 0.5723, lr_0 = 1.3918e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 58
Loss = 1.3722e-01, PNorm = 35.8048, GNorm = 0.9756, lr_0 = 1.3043e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 59
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 60
Loss = 1.2783e-01, PNorm = 35.8131, GNorm = 1.7105, lr_0 = 1.2295e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 61
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 62
Loss = 1.7767e-01, PNorm = 35.8221, GNorm = 0.8827, lr_0 = 1.1522e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 63
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 64
Loss = 1.3695e-01, PNorm = 35.8301, GNorm = 0.4706, lr_0 = 1.0798e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 65
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 66
Loss = 2.0348e-01, PNorm = 35.8378, GNorm = 0.5936, lr_0 = 1.0119e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 67
Loss = 1.4087e-01, PNorm = 35.8447, GNorm = 0.4458, lr_0 = 1.0000e-04
Loss = 4.6940e-02, PNorm = 35.8454, GNorm = 0.7806, lr_0 = 1.0000e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 68
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 69
Loss = 1.3366e-01, PNorm = 35.8522, GNorm = 0.9539, lr_0 = 1.0000e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 70
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 71
Loss = 8.8076e-02, PNorm = 35.8606, GNorm = 2.8007, lr_0 = 1.0000e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 72
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 73
Loss = 9.5537e-02, PNorm = 35.8680, GNorm = 1.0700, lr_0 = 1.0000e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 74
Loss = 1.2034e-01, PNorm = 35.8739, GNorm = 0.6093, lr_0 = 1.0000e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 75
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 76
Loss = 1.3028e-01, PNorm = 35.8808, GNorm = 0.8045, lr_0 = 1.0000e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 77
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.764706
Epoch 78
Loss = 1.2602e-01, PNorm = 35.8879, GNorm = 0.8597, lr_0 = 1.0000e-04
Validation auc = 0.881423
Validation prc-auc = 0.598878
Validation accuracy = 0.852941
Epoch 79
Validation auc = 0.881423
Validation prc-auc = 0.598878
Validation accuracy = 0.764706
Model 0 best validation auc = 0.972332 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.861607
Model 0 test prc-auc = 0.480952
Model 0 test accuracy = 0.820513
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.924901
Validation prc-auc = 0.941454
Validation accuracy = 0.676471
Epoch 1
Loss = 6.6235e-01, PNorm = 34.0140, GNorm = 0.6740, lr_0 = 9.8826e-04
Validation auc = 0.960474
Validation prc-auc = 0.955742
Validation accuracy = 0.676471
Epoch 2
Validation auc = 0.948617
Validation prc-auc = 0.949752
Validation accuracy = 0.676471
Epoch 3
Loss = 6.2977e-01, PNorm = 34.0712, GNorm = 0.3075, lr_0 = 9.2612e-04
Validation auc = 0.960474
Validation prc-auc = 0.955742
Validation accuracy = 0.676471
Epoch 4
Validation auc = 0.960474
Validation prc-auc = 0.955742
Validation accuracy = 0.676471
Epoch 5
Loss = 6.2137e-01, PNorm = 34.1386, GNorm = 1.0379, lr_0 = 8.7302e-04
Validation auc = 0.960474
Validation prc-auc = 0.955742
Validation accuracy = 0.676471
Epoch 6
Validation auc = 0.960474
Validation prc-auc = 0.955742
Validation accuracy = 0.882353
Epoch 7
Loss = 5.7431e-01, PNorm = 34.2305, GNorm = 0.4912, lr_0 = 8.1813e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.882353
Epoch 8
Loss = 5.3496e-01, PNorm = 34.3463, GNorm = 0.6044, lr_0 = 7.6668e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.882353
Epoch 9
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.882353
Epoch 10
Loss = 4.8236e-01, PNorm = 34.4693, GNorm = 1.0681, lr_0 = 7.2273e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.882353
Epoch 11
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.882353
Epoch 12
Loss = 4.1239e-01, PNorm = 34.5694, GNorm = 0.8663, lr_0 = 6.7728e-04
Validation auc = 0.960474
Validation prc-auc = 0.955742
Validation accuracy = 0.970588
Epoch 13
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.882353
Epoch 14
Loss = 4.0679e-01, PNorm = 34.6730, GNorm = 0.7376, lr_0 = 6.3469e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 15
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.970588
Epoch 16
Loss = 4.6235e-01, PNorm = 34.7811, GNorm = 1.9735, lr_0 = 5.9478e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.882353
Epoch 17
Loss = 3.6238e-01, PNorm = 34.8718, GNorm = 2.8872, lr_0 = 5.6068e-04
Loss = 3.3998e-01, PNorm = 34.8809, GNorm = 2.7841, lr_0 = 5.5738e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.882353
Epoch 18
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 19
Loss = 3.0329e-01, PNorm = 34.9674, GNorm = 0.3495, lr_0 = 5.2543e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 20
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 21
Loss = 2.6377e-01, PNorm = 35.0586, GNorm = 1.6318, lr_0 = 4.9239e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 22
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 23
Loss = 2.5382e-01, PNorm = 35.1447, GNorm = 3.0671, lr_0 = 4.6143e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 24
Loss = 2.5943e-01, PNorm = 35.2182, GNorm = 5.2252, lr_0 = 4.3497e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 25
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 26
Loss = 2.4641e-01, PNorm = 35.2826, GNorm = 2.5232, lr_0 = 4.0762e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.852941
Epoch 27
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.852941
Epoch 28
Loss = 1.8834e-01, PNorm = 35.3450, GNorm = 0.3761, lr_0 = 3.8199e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 29
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 30
Loss = 1.8720e-01, PNorm = 35.3922, GNorm = 0.5850, lr_0 = 3.6009e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 31
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.852941
Epoch 32
Loss = 1.7897e-01, PNorm = 35.4398, GNorm = 0.7643, lr_0 = 3.3745e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 33
Loss = 1.8531e-01, PNorm = 35.4821, GNorm = 2.6152, lr_0 = 3.1623e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 34
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.852941
Epoch 35
Loss = 2.0535e-01, PNorm = 35.5164, GNorm = 1.6071, lr_0 = 2.9810e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 36
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.852941
Epoch 37
Loss = 1.9480e-01, PNorm = 35.5518, GNorm = 3.7870, lr_0 = 2.7935e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 38
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 39
Loss = 1.5243e-01, PNorm = 35.5819, GNorm = 1.5836, lr_0 = 2.6179e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 40
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 41
Loss = 1.8023e-01, PNorm = 35.6109, GNorm = 1.0497, lr_0 = 2.4533e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 42
Loss = 1.8147e-01, PNorm = 35.6342, GNorm = 0.7596, lr_0 = 2.3126e-04
Loss = 8.4388e-02, PNorm = 35.6363, GNorm = 0.6162, lr_0 = 2.2990e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 43
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 44
Loss = 1.5266e-01, PNorm = 35.6566, GNorm = 3.8706, lr_0 = 2.1672e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 45
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 46
Loss = 1.5474e-01, PNorm = 35.6787, GNorm = 0.9089, lr_0 = 2.0309e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 47
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 48
Loss = 1.4423e-01, PNorm = 35.6987, GNorm = 1.3882, lr_0 = 1.9032e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 49
Loss = 1.6706e-01, PNorm = 35.7166, GNorm = 1.8192, lr_0 = 1.7941e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 50
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 51
Loss = 1.5085e-01, PNorm = 35.7331, GNorm = 3.2694, lr_0 = 1.6813e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 52
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 53
Loss = 1.7041e-01, PNorm = 35.7491, GNorm = 0.4407, lr_0 = 1.5756e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 54
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 55
Loss = 1.8415e-01, PNorm = 35.7639, GNorm = 1.5620, lr_0 = 1.4852e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 56
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 57
Loss = 2.7366e-01, PNorm = 35.7778, GNorm = 1.0014, lr_0 = 1.3918e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 58
Loss = 1.4611e-01, PNorm = 35.7911, GNorm = 3.0120, lr_0 = 1.3043e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 59
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 60
Loss = 1.5581e-01, PNorm = 35.8007, GNorm = 2.5924, lr_0 = 1.2295e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 61
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 62
Loss = 1.4527e-01, PNorm = 35.8114, GNorm = 1.0932, lr_0 = 1.1522e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 63
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 64
Loss = 9.7166e-02, PNorm = 35.8218, GNorm = 0.4775, lr_0 = 1.0798e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 65
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 66
Loss = 1.1156e-01, PNorm = 35.8322, GNorm = 1.2588, lr_0 = 1.0119e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 67
Loss = 1.6277e-01, PNorm = 35.8410, GNorm = 4.9374, lr_0 = 1.0000e-04
Loss = 9.5729e-02, PNorm = 35.8419, GNorm = 0.9076, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 68
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 69
Loss = 1.5844e-01, PNorm = 35.8496, GNorm = 1.2999, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 70
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 71
Loss = 1.5867e-01, PNorm = 35.8589, GNorm = 1.0775, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 72
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 73
Loss = 1.9752e-01, PNorm = 35.8678, GNorm = 4.2772, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 74
Loss = 1.3901e-01, PNorm = 35.8756, GNorm = 1.6751, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 75
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 76
Loss = 1.3638e-01, PNorm = 35.8843, GNorm = 0.6738, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 77
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 78
Loss = 1.0289e-01, PNorm = 35.8931, GNorm = 1.5505, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 79
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Model 1 best validation auc = 0.996047 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.781250
Model 1 test prc-auc = 0.290476
Model 1 test accuracy = 0.820513
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.924901
Validation prc-auc = 0.941454
Validation accuracy = 0.676471
Epoch 1
Loss = 6.2211e-01, PNorm = 34.0247, GNorm = 0.6567, lr_0 = 9.8826e-04
Validation auc = 0.960474
Validation prc-auc = 0.955742
Validation accuracy = 0.676471
Epoch 2
Validation auc = 0.901186
Validation prc-auc = 0.849742
Validation accuracy = 0.676471
Epoch 3
Loss = 6.1967e-01, PNorm = 34.0872, GNorm = 0.9030, lr_0 = 9.2612e-04
Validation auc = 0.901186
Validation prc-auc = 0.849742
Validation accuracy = 0.676471
Epoch 4
Validation auc = 0.877470
Validation prc-auc = 0.830696
Validation accuracy = 0.882353
Epoch 5
Loss = 5.7887e-01, PNorm = 34.1592, GNorm = 1.1334, lr_0 = 8.7302e-04
Validation auc = 0.877470
Validation prc-auc = 0.830696
Validation accuracy = 0.882353
Epoch 6
Validation auc = 0.830040
Validation prc-auc = 0.827769
Validation accuracy = 0.882353
Epoch 7
Loss = 5.7576e-01, PNorm = 34.2647, GNorm = 2.2161, lr_0 = 8.1813e-04
Validation auc = 0.901186
Validation prc-auc = 0.865311
Validation accuracy = 0.882353
Epoch 8
Loss = 5.1986e-01, PNorm = 34.3890, GNorm = 1.3734, lr_0 = 7.6668e-04
Validation auc = 0.948617
Validation prc-auc = 0.949752
Validation accuracy = 0.588235
Epoch 9
Validation auc = 0.794466
Validation prc-auc = 0.815390
Validation accuracy = 0.676471
Epoch 10
Loss = 4.9365e-01, PNorm = 34.4883, GNorm = 1.6024, lr_0 = 7.2273e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.882353
Epoch 11
Validation auc = 0.948617
Validation prc-auc = 0.949752
Validation accuracy = 0.588235
Epoch 12
Loss = 4.1167e-01, PNorm = 34.6033, GNorm = 1.6958, lr_0 = 6.7728e-04
Validation auc = 0.774704
Validation prc-auc = 0.530799
Validation accuracy = 0.676471
Epoch 13
Validation auc = 0.774704
Validation prc-auc = 0.530799
Validation accuracy = 0.852941
Epoch 14
Loss = 3.9371e-01, PNorm = 34.7244, GNorm = 1.3840, lr_0 = 6.3469e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.852941
Epoch 15
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 16
Loss = 3.0949e-01, PNorm = 34.8438, GNorm = 0.5515, lr_0 = 5.9478e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 17
Loss = 3.0944e-01, PNorm = 34.9357, GNorm = 1.0690, lr_0 = 5.6068e-04
Loss = 2.4000e-01, PNorm = 34.9449, GNorm = 2.6480, lr_0 = 5.5738e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 18
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.764706
Epoch 19
Loss = 2.6473e-01, PNorm = 35.0246, GNorm = 2.0003, lr_0 = 5.2543e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 20
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 21
Loss = 2.2558e-01, PNorm = 35.0962, GNorm = 0.4499, lr_0 = 4.9239e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 22
Validation auc = 0.936759
Validation prc-auc = 0.895848
Validation accuracy = 0.852941
Epoch 23
Loss = 3.1703e-01, PNorm = 35.1585, GNorm = 1.3560, lr_0 = 4.6143e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 24
Loss = 2.3067e-01, PNorm = 35.2151, GNorm = 1.6849, lr_0 = 4.3497e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 25
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 26
Loss = 1.8753e-01, PNorm = 35.2691, GNorm = 1.2497, lr_0 = 4.0762e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 27
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 28
Loss = 1.9363e-01, PNorm = 35.3199, GNorm = 1.0279, lr_0 = 3.8199e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 29
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 30
Loss = 2.0647e-01, PNorm = 35.3671, GNorm = 2.5921, lr_0 = 3.6009e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 31
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 32
Loss = 2.0000e-01, PNorm = 35.4140, GNorm = 2.2789, lr_0 = 3.3745e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.941176
Epoch 33
Loss = 2.2004e-01, PNorm = 35.4530, GNorm = 0.9831, lr_0 = 3.1623e-04
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.764706
Epoch 34
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 35
Loss = 2.0194e-01, PNorm = 35.4832, GNorm = 2.2595, lr_0 = 2.9810e-04
Validation auc = 0.881423
Validation prc-auc = 0.598878
Validation accuracy = 0.764706
Epoch 36
Validation auc = 0.996047
Validation prc-auc = 0.993007
Validation accuracy = 0.852941
Epoch 37
Loss = 1.8735e-01, PNorm = 35.5183, GNorm = 0.4950, lr_0 = 2.7935e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 38
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 39
Loss = 2.0706e-01, PNorm = 35.5480, GNorm = 1.0677, lr_0 = 2.6179e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 40
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 41
Loss = 1.8395e-01, PNorm = 35.5763, GNorm = 1.8149, lr_0 = 2.4533e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 42
Loss = 1.5708e-01, PNorm = 35.5978, GNorm = 0.6670, lr_0 = 2.3126e-04
Loss = 2.0700e-01, PNorm = 35.5998, GNorm = 1.4917, lr_0 = 2.2990e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 43
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 44
Loss = 1.4537e-01, PNorm = 35.6189, GNorm = 0.7598, lr_0 = 2.1672e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 45
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 46
Loss = 1.6667e-01, PNorm = 35.6398, GNorm = 3.3445, lr_0 = 2.0309e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 47
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 48
Loss = 1.0626e-01, PNorm = 35.6570, GNorm = 2.0177, lr_0 = 1.9032e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 49
Loss = 1.6221e-01, PNorm = 35.6726, GNorm = 1.9066, lr_0 = 1.7941e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 50
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 51
Loss = 1.4708e-01, PNorm = 35.6874, GNorm = 1.7329, lr_0 = 1.6813e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 52
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 53
Loss = 1.7789e-01, PNorm = 35.7011, GNorm = 2.7381, lr_0 = 1.5756e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 54
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 55
Loss = 1.0372e-01, PNorm = 35.7134, GNorm = 0.8347, lr_0 = 1.4852e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 56
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 57
Loss = 1.2219e-01, PNorm = 35.7261, GNorm = 0.9653, lr_0 = 1.3918e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 58
Loss = 1.3562e-01, PNorm = 35.7370, GNorm = 0.6172, lr_0 = 1.3043e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 59
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 60
Loss = 1.4938e-01, PNorm = 35.7472, GNorm = 1.7271, lr_0 = 1.2295e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 61
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 62
Loss = 1.5981e-01, PNorm = 35.7574, GNorm = 3.0750, lr_0 = 1.1522e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 63
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 64
Loss = 1.1478e-01, PNorm = 35.7655, GNorm = 0.8132, lr_0 = 1.0798e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 65
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 66
Loss = 1.9212e-01, PNorm = 35.7724, GNorm = 1.4514, lr_0 = 1.0119e-04
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 67
Loss = 1.3742e-01, PNorm = 35.7798, GNorm = 2.1617, lr_0 = 1.0000e-04
Loss = 1.1327e-01, PNorm = 35.7805, GNorm = 1.9618, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 68
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 69
Loss = 1.4223e-01, PNorm = 35.7869, GNorm = 0.6044, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 70
Validation auc = 0.916996
Validation prc-auc = 0.645688
Validation accuracy = 0.852941
Epoch 71
Loss = 1.6725e-01, PNorm = 35.7944, GNorm = 7.7224, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 72
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 73
Loss = 1.5186e-01, PNorm = 35.8024, GNorm = 1.6693, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 74
Loss = 1.3952e-01, PNorm = 35.8101, GNorm = 2.4322, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.941176
Epoch 75
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 76
Loss = 1.4878e-01, PNorm = 35.8176, GNorm = 0.8173, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 77
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 78
Loss = 1.4372e-01, PNorm = 35.8244, GNorm = 0.4451, lr_0 = 1.0000e-04
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Epoch 79
Validation auc = 0.972332
Validation prc-auc = 0.942657
Validation accuracy = 0.852941
Model 2 best validation auc = 0.996047 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.888393
Model 2 test prc-auc = 0.719048
Model 2 test accuracy = 0.897436
Ensemble test auc = 0.928571
Ensemble test prc-auc = 0.767857
Ensemble test accuracy = 0.820513
Fold 3
Splitting data with seed 3
Total scaffolds = 65 | train scaffolds = 43 | val scaffolds = 10 | test scaffolds = 12
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 33 | target average = 1.000000


Scaffold 1
Task 0: count = 24 | target average = 0.041667


Scaffold 2
Task 0: count = 21 | target average = 1.000000


Scaffold 3
Task 0: count = 21 | target average = 0.000000


Scaffold 4
Task 0: count = 14 | target average = 0.000000


Scaffold 5
Task 0: count = 12 | target average = 0.083333


Scaffold 6
Task 0: count = 9 | target average = 0.000000


Scaffold 7
Task 0: count = 7 | target average = 1.000000


Scaffold 8
Task 0: count = 6 | target average = 0.000000


Scaffold 9
Task 0: count = 6 | target average = 0.833333


Class sizes
bin_activity 0: 69.12%, 1: 30.88%
Total size = 353 | train size = 281 | val size = 33 | test size = 39
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 1
Loss = 6.4083e-01, PNorm = 34.0258, GNorm = 0.2918, lr_0 = 9.8826e-04
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 2
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 3
Loss = 6.0442e-01, PNorm = 34.0980, GNorm = 0.4013, lr_0 = 9.2612e-04
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.818182
Epoch 4
Validation auc = 0.200000
Validation prc-auc = 0.052525
Validation accuracy = 0.818182
Epoch 5
Loss = 5.7573e-01, PNorm = 34.1951, GNorm = 0.3808, lr_0 = 8.7302e-04
Validation auc = 0.200000
Validation prc-auc = 0.052525
Validation accuracy = 0.818182
Epoch 6
Validation auc = 0.300000
Validation prc-auc = 0.060185
Validation accuracy = 0.909091
Epoch 7
Loss = 6.8139e-01, PNorm = 34.3201, GNorm = 3.7867, lr_0 = 8.1813e-04
Validation auc = 0.233333
Validation prc-auc = 0.054938
Validation accuracy = 0.818182
Epoch 8
Loss = 4.4402e-01, PNorm = 34.4513, GNorm = 0.7798, lr_0 = 7.6668e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.727273
Epoch 9
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.727273
Epoch 10
Loss = 4.4586e-01, PNorm = 34.5791, GNorm = 4.7619, lr_0 = 7.2273e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 11
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.545455
Epoch 12
Loss = 3.2141e-01, PNorm = 34.7009, GNorm = 2.1474, lr_0 = 6.7728e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.818182
Epoch 13
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.727273
Epoch 14
Loss = 2.7452e-01, PNorm = 34.8199, GNorm = 4.2763, lr_0 = 6.3469e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.545455
Epoch 15
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 16
Loss = 3.3057e-01, PNorm = 34.9183, GNorm = 2.2401, lr_0 = 5.9478e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 17
Loss = 2.4025e-01, PNorm = 34.9891, GNorm = 0.7288, lr_0 = 5.6068e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 18
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.727273
Epoch 19
Loss = 2.6025e-01, PNorm = 35.0467, GNorm = 6.4010, lr_0 = 5.2543e-04
Validation auc = 0.266667
Validation prc-auc = 0.060185
Validation accuracy = 0.818182
Epoch 20
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.545455
Epoch 21
Loss = 2.7364e-01, PNorm = 35.0956, GNorm = 1.5270, lr_0 = 4.9530e-04
Validation auc = 0.266667
Validation prc-auc = 0.060185
Validation accuracy = 0.636364
Epoch 22
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 23
Loss = 1.8500e-01, PNorm = 35.1378, GNorm = 0.7111, lr_0 = 4.6416e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 24
Loss = 1.7750e-01, PNorm = 35.1781, GNorm = 1.1002, lr_0 = 4.3497e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 25
Validation auc = 0.266667
Validation prc-auc = 0.060185
Validation accuracy = 0.636364
Epoch 26
Loss = 1.9558e-01, PNorm = 35.2109, GNorm = 2.6654, lr_0 = 4.1003e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 27
Validation auc = 0.266667
Validation prc-auc = 0.060185
Validation accuracy = 0.636364
Epoch 28
Loss = 2.1270e-01, PNorm = 35.2432, GNorm = 1.8678, lr_0 = 3.8425e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.636364
Epoch 29
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.545455
Epoch 30
Loss = 1.6618e-01, PNorm = 35.2780, GNorm = 1.5410, lr_0 = 3.6009e-04
Validation auc = 0.266667
Validation prc-auc = 0.060185
Validation accuracy = 0.636364
Epoch 31
Validation auc = 0.233333
Validation prc-auc = 0.056790
Validation accuracy = 0.636364
Epoch 32
Loss = 1.6204e-01, PNorm = 35.3122, GNorm = 1.6077, lr_0 = 3.3745e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.636364
Epoch 33
Loss = 1.5001e-01, PNorm = 35.3430, GNorm = 3.1983, lr_0 = 3.1810e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.636364
Epoch 34
Validation auc = 0.233333
Validation prc-auc = 0.054938
Validation accuracy = 0.545455
Epoch 35
Loss = 1.5359e-01, PNorm = 35.3675, GNorm = 2.2424, lr_0 = 2.9810e-04
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.545455
Epoch 36
Validation auc = 0.133333
Validation prc-auc = 0.051852
Validation accuracy = 0.636364
Epoch 37
Loss = 1.2239e-01, PNorm = 35.3966, GNorm = 2.5601, lr_0 = 2.7935e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 38
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.636364
Epoch 39
Loss = 1.9885e-01, PNorm = 35.4178, GNorm = 3.3973, lr_0 = 2.6334e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.636364
Epoch 40
Loss = 1.4131e-01, PNorm = 35.4405, GNorm = 0.6380, lr_0 = 2.4678e-04
Validation auc = 0.133333
Validation prc-auc = 0.049351
Validation accuracy = 0.636364
Epoch 41
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.636364
Epoch 42
Loss = 1.1973e-01, PNorm = 35.4613, GNorm = 0.7683, lr_0 = 2.3263e-04
Validation auc = 0.066667
Validation prc-auc = 0.047587
Validation accuracy = 0.454545
Epoch 43
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 44
Loss = 2.0019e-01, PNorm = 35.4806, GNorm = 0.6521, lr_0 = 2.1800e-04
Validation auc = 0.133333
Validation prc-auc = 0.051852
Validation accuracy = 0.636364
Epoch 45
Validation auc = 0.200000
Validation prc-auc = 0.053616
Validation accuracy = 0.545455
Epoch 46
Loss = 1.3365e-01, PNorm = 35.5001, GNorm = 2.6044, lr_0 = 2.0429e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.636364
Epoch 47
Validation auc = 0.133333
Validation prc-auc = 0.051852
Validation accuracy = 0.636364
Epoch 48
Loss = 1.3328e-01, PNorm = 35.5176, GNorm = 2.1345, lr_0 = 1.9145e-04
Validation auc = 0.133333
Validation prc-auc = 0.051852
Validation accuracy = 0.636364
Epoch 49
Loss = 1.1868e-01, PNorm = 35.5330, GNorm = 1.6005, lr_0 = 1.8047e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.454545
Epoch 50
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.636364
Epoch 51
Loss = 1.4238e-01, PNorm = 35.5473, GNorm = 0.6786, lr_0 = 1.6912e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.545455
Epoch 52
Validation auc = 0.166667
Validation prc-auc = 0.053704
Validation accuracy = 0.636364
Epoch 53
Loss = 1.3738e-01, PNorm = 35.5614, GNorm = 1.3051, lr_0 = 1.5849e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 54
Validation auc = 0.166667
Validation prc-auc = 0.053704
Validation accuracy = 0.636364
Epoch 55
Loss = 1.5116e-01, PNorm = 35.5730, GNorm = 2.3932, lr_0 = 1.4940e-04
Validation auc = 0.200000
Validation prc-auc = 0.053616
Validation accuracy = 0.545455
Epoch 56
Loss = 1.3720e-01, PNorm = 35.5843, GNorm = 1.1804, lr_0 = 1.4001e-04
Validation auc = 0.133333
Validation prc-auc = 0.051852
Validation accuracy = 0.636364
Epoch 57
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 58
Loss = 1.3817e-01, PNorm = 35.5949, GNorm = 2.7530, lr_0 = 1.3120e-04
Validation auc = 0.133333
Validation prc-auc = 0.051852
Validation accuracy = 0.636364
Epoch 59
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 60
Loss = 9.7906e-02, PNorm = 35.6030, GNorm = 2.7417, lr_0 = 1.2368e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 61
Validation auc = 0.200000
Validation prc-auc = 0.053616
Validation accuracy = 0.636364
Epoch 62
Loss = 1.4655e-01, PNorm = 35.6122, GNorm = 0.6674, lr_0 = 1.1591e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 63
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 64
Loss = 9.8354e-02, PNorm = 35.6222, GNorm = 1.4414, lr_0 = 1.0862e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 65
Loss = 9.4230e-02, PNorm = 35.6295, GNorm = 0.7474, lr_0 = 1.0239e-04
Loss = 2.1513e-01, PNorm = 35.6302, GNorm = 5.0632, lr_0 = 1.0179e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 66
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 67
Loss = 8.1808e-02, PNorm = 35.6371, GNorm = 3.1138, lr_0 = 1.0000e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 68
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 69
Loss = 1.0615e-01, PNorm = 35.6436, GNorm = 4.2759, lr_0 = 1.0000e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 70
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 71
Loss = 6.4654e-02, PNorm = 35.6501, GNorm = 1.5514, lr_0 = 1.0000e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.545455
Epoch 72
Loss = 1.0942e-01, PNorm = 35.6564, GNorm = 2.4294, lr_0 = 1.0000e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 73
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 74
Loss = 1.0495e-01, PNorm = 35.6631, GNorm = 0.8321, lr_0 = 1.0000e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 75
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.545455
Epoch 76
Loss = 1.2193e-01, PNorm = 35.6693, GNorm = 3.1742, lr_0 = 1.0000e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 77
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Epoch 78
Loss = 9.8989e-02, PNorm = 35.6760, GNorm = 0.8097, lr_0 = 1.0000e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.545455
Epoch 79
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.636364
Model 0 best validation auc = 0.300000 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.821429
Model 0 test prc-auc = 0.389683
Model 0 test accuracy = 0.820513
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.333333
Validation prc-auc = 0.062037
Validation accuracy = 0.909091
Epoch 1
Loss = 6.4523e-01, PNorm = 34.0178, GNorm = 1.3877, lr_0 = 9.8826e-04
Validation auc = 0.233333
Validation prc-auc = 0.054938
Validation accuracy = 0.909091
Epoch 2
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 3
Loss = 6.1640e-01, PNorm = 34.0763, GNorm = 0.5024, lr_0 = 9.2612e-04
Validation auc = 0.233333
Validation prc-auc = 0.054938
Validation accuracy = 0.909091
Epoch 4
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 5
Loss = 5.8805e-01, PNorm = 34.1506, GNorm = 0.4862, lr_0 = 8.7302e-04
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.636364
Epoch 6
Validation auc = 0.266667
Validation prc-auc = 0.059933
Validation accuracy = 0.909091
Epoch 7
Loss = 6.5904e-01, PNorm = 34.2515, GNorm = 1.0773, lr_0 = 8.1813e-04
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.818182
Epoch 8
Loss = 5.1657e-01, PNorm = 34.3623, GNorm = 0.3297, lr_0 = 7.6668e-04
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.818182
Epoch 9
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.727273
Epoch 10
Loss = 5.0416e-01, PNorm = 34.4701, GNorm = 1.2393, lr_0 = 7.2273e-04
Validation auc = 0.366667
Validation prc-auc = 0.068452
Validation accuracy = 0.818182
Epoch 11
Validation auc = 0.400000
Validation prc-auc = 0.069444
Validation accuracy = 0.818182
Epoch 12
Loss = 4.2252e-01, PNorm = 34.5925, GNorm = 0.4175, lr_0 = 6.7728e-04
Validation auc = 0.400000
Validation prc-auc = 0.069444
Validation accuracy = 0.727273
Epoch 13
Validation auc = 0.133333
Validation prc-auc = 0.051852
Validation accuracy = 0.272727
Epoch 14
Loss = 4.5854e-01, PNorm = 34.7000, GNorm = 1.4311, lr_0 = 6.3469e-04
Validation auc = 0.666667
Validation prc-auc = 0.116402
Validation accuracy = 0.727273
Epoch 15
Validation auc = 0.333333
Validation prc-auc = 0.064153
Validation accuracy = 0.818182
Epoch 16
Loss = 3.5976e-01, PNorm = 34.7999, GNorm = 0.9833, lr_0 = 5.9478e-04
Validation auc = 0.300000
Validation prc-auc = 0.060758
Validation accuracy = 0.727273
Epoch 17
Loss = 3.9419e-01, PNorm = 34.8602, GNorm = 0.5029, lr_0 = 5.6068e-04
Validation auc = 0.466667
Validation prc-auc = 0.076852
Validation accuracy = 0.727273
Epoch 18
Validation auc = 0.400000
Validation prc-auc = 0.069444
Validation accuracy = 0.727273
Epoch 19
Loss = 3.3430e-01, PNorm = 34.9475, GNorm = 0.8204, lr_0 = 5.2543e-04
Validation auc = 0.333333
Validation prc-auc = 0.064153
Validation accuracy = 0.545455
Epoch 20
Validation auc = 0.333333
Validation prc-auc = 0.064153
Validation accuracy = 0.727273
Epoch 21
Loss = 2.5814e-01, PNorm = 35.0236, GNorm = 0.4729, lr_0 = 4.9530e-04
Validation auc = 0.333333
Validation prc-auc = 0.064153
Validation accuracy = 0.727273
Epoch 22
Validation auc = 0.266667
Validation prc-auc = 0.060185
Validation accuracy = 0.545455
Epoch 23
Loss = 2.8099e-01, PNorm = 35.1058, GNorm = 1.8200, lr_0 = 4.6416e-04
Validation auc = 0.266667
Validation prc-auc = 0.060185
Validation accuracy = 0.545455
Epoch 24
Loss = 2.3041e-01, PNorm = 35.1837, GNorm = 1.6303, lr_0 = 4.3497e-04
Validation auc = 0.333333
Validation prc-auc = 0.064153
Validation accuracy = 0.636364
Epoch 25
Validation auc = 0.333333
Validation prc-auc = 0.064153
Validation accuracy = 0.636364
Epoch 26
Loss = 2.3277e-01, PNorm = 35.2449, GNorm = 2.2166, lr_0 = 4.1003e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 27
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 28
Loss = 2.1021e-01, PNorm = 35.3036, GNorm = 1.2138, lr_0 = 3.8425e-04
Validation auc = 0.300000
Validation prc-auc = 0.060758
Validation accuracy = 0.636364
Epoch 29
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.727273
Epoch 30
Loss = 2.1758e-01, PNorm = 35.3575, GNorm = 2.0997, lr_0 = 3.6009e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.818182
Epoch 31
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.818182
Epoch 32
Loss = 2.3552e-01, PNorm = 35.3989, GNorm = 2.8545, lr_0 = 3.3745e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 33
Loss = 1.9538e-01, PNorm = 35.4383, GNorm = 4.0815, lr_0 = 3.1810e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 34
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.818182
Epoch 35
Loss = 1.6423e-01, PNorm = 35.4734, GNorm = 4.1926, lr_0 = 2.9810e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 36
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.818182
Epoch 37
Loss = 1.4858e-01, PNorm = 35.5048, GNorm = 1.4726, lr_0 = 2.7935e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 38
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.727273
Epoch 39
Loss = 2.0319e-01, PNorm = 35.5304, GNorm = 1.1800, lr_0 = 2.6334e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.818182
Epoch 40
Loss = 1.7265e-01, PNorm = 35.5586, GNorm = 1.0984, lr_0 = 2.4678e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 41
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 42
Loss = 1.1823e-01, PNorm = 35.5801, GNorm = 1.4858, lr_0 = 2.3263e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 43
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.818182
Epoch 44
Loss = 1.6258e-01, PNorm = 35.6023, GNorm = 4.7007, lr_0 = 2.1800e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 45
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 46
Loss = 1.5112e-01, PNorm = 35.6234, GNorm = 1.4432, lr_0 = 2.0429e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 47
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 48
Loss = 7.6834e-02, PNorm = 35.6451, GNorm = 1.2182, lr_0 = 1.9145e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.727273
Epoch 49
Loss = 1.4463e-01, PNorm = 35.6603, GNorm = 1.0290, lr_0 = 1.8047e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 50
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.727273
Epoch 51
Loss = 1.5650e-01, PNorm = 35.6768, GNorm = 1.0530, lr_0 = 1.6912e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.454545
Epoch 52
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 53
Loss = 1.5329e-01, PNorm = 35.6922, GNorm = 3.5710, lr_0 = 1.5849e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 54
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 55
Loss = 1.5229e-01, PNorm = 35.7043, GNorm = 1.0214, lr_0 = 1.4940e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 56
Loss = 1.5134e-01, PNorm = 35.7177, GNorm = 2.6399, lr_0 = 1.4001e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 57
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.727273
Epoch 58
Loss = 1.4051e-01, PNorm = 35.7298, GNorm = 1.0278, lr_0 = 1.3120e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 59
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 60
Loss = 1.0855e-01, PNorm = 35.7416, GNorm = 1.1208, lr_0 = 1.2368e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 61
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 62
Loss = 1.5784e-01, PNorm = 35.7525, GNorm = 1.2875, lr_0 = 1.1591e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 63
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 64
Loss = 1.0537e-01, PNorm = 35.7635, GNorm = 1.1041, lr_0 = 1.0862e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 65
Loss = 1.3511e-01, PNorm = 35.7717, GNorm = 1.0487, lr_0 = 1.0239e-04
Loss = 7.6895e-02, PNorm = 35.7726, GNorm = 0.5769, lr_0 = 1.0179e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 66
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 67
Loss = 1.4662e-01, PNorm = 35.7815, GNorm = 2.5256, lr_0 = 1.0000e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 68
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 69
Loss = 1.3527e-01, PNorm = 35.7912, GNorm = 1.3567, lr_0 = 1.0000e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 70
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 71
Loss = 2.2654e-01, PNorm = 35.8005, GNorm = 2.2338, lr_0 = 1.0000e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 72
Loss = 1.2348e-01, PNorm = 35.8111, GNorm = 0.3629, lr_0 = 1.0000e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.636364
Epoch 73
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.545455
Epoch 74
Loss = 1.3322e-01, PNorm = 35.8201, GNorm = 0.4559, lr_0 = 1.0000e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 75
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 76
Loss = 1.3703e-01, PNorm = 35.8287, GNorm = 3.2929, lr_0 = 1.0000e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 77
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 78
Loss = 1.0998e-01, PNorm = 35.8384, GNorm = 2.1080, lr_0 = 1.0000e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 79
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Model 1 best validation auc = 0.666667 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.928571
Model 1 test prc-auc = 0.898384
Model 1 test accuracy = 0.820513
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.233333
Validation prc-auc = 0.054938
Validation accuracy = 0.909091
Epoch 1
Loss = 6.4020e-01, PNorm = 34.0350, GNorm = 1.0576, lr_0 = 9.8826e-04
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 2
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 3
Loss = 5.8365e-01, PNorm = 34.1186, GNorm = 0.3452, lr_0 = 9.2612e-04
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.818182
Epoch 4
Validation auc = 0.166667
Validation prc-auc = 0.050673
Validation accuracy = 0.909091
Epoch 5
Loss = 5.8071e-01, PNorm = 34.2192, GNorm = 1.9282, lr_0 = 8.7302e-04
Validation auc = 0.266667
Validation prc-auc = 0.058862
Validation accuracy = 0.909091
Epoch 6
Validation auc = 0.166667
Validation prc-auc = 0.052623
Validation accuracy = 0.454545
Epoch 7
Loss = 5.0865e-01, PNorm = 34.3254, GNorm = 1.0403, lr_0 = 8.1813e-04
Validation auc = 0.066667
Validation prc-auc = 0.048485
Validation accuracy = 0.454545
Epoch 8
Loss = 4.5886e-01, PNorm = 34.4471, GNorm = 2.4089, lr_0 = 7.6668e-04
Validation auc = 0.300000
Validation prc-auc = 0.060758
Validation accuracy = 0.545455
Epoch 9
Validation auc = 0.233333
Validation prc-auc = 0.056790
Validation accuracy = 0.818182
Epoch 10
Loss = 4.1520e-01, PNorm = 34.5567, GNorm = 0.6298, lr_0 = 7.2273e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.545455
Epoch 11
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 12
Loss = 3.4676e-01, PNorm = 34.6748, GNorm = 1.4378, lr_0 = 6.7728e-04
Validation auc = 0.333333
Validation prc-auc = 0.064153
Validation accuracy = 0.818182
Epoch 13
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 14
Loss = 2.8995e-01, PNorm = 34.7860, GNorm = 1.6562, lr_0 = 6.3469e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.545455
Epoch 15
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.545455
Epoch 16
Loss = 3.0375e-01, PNorm = 34.8908, GNorm = 0.5288, lr_0 = 5.9478e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.818182
Epoch 17
Loss = 2.6886e-01, PNorm = 34.9733, GNorm = 4.1155, lr_0 = 5.6068e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.818182
Epoch 18
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.545455
Epoch 19
Loss = 2.2825e-01, PNorm = 35.0511, GNorm = 0.7287, lr_0 = 5.2543e-04
Validation auc = 0.300000
Validation prc-auc = 0.060758
Validation accuracy = 0.818182
Epoch 20
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.636364
Epoch 21
Loss = 1.8042e-01, PNorm = 35.1221, GNorm = 1.6921, lr_0 = 4.9530e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.545455
Epoch 22
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.818182
Epoch 23
Loss = 1.3443e-01, PNorm = 35.1858, GNorm = 0.3147, lr_0 = 4.6416e-04
Validation auc = 0.066667
Validation prc-auc = 0.048485
Validation accuracy = 0.454545
Epoch 24
Loss = 2.0689e-01, PNorm = 35.2420, GNorm = 1.2958, lr_0 = 4.3497e-04
Validation auc = 0.266667
Validation prc-auc = 0.058009
Validation accuracy = 0.727273
Epoch 25
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 26
Loss = 2.1662e-01, PNorm = 35.2928, GNorm = 1.3027, lr_0 = 4.1003e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.636364
Epoch 27
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 28
Loss = 2.2240e-01, PNorm = 35.3365, GNorm = 3.0147, lr_0 = 3.8425e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.818182
Epoch 29
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 30
Loss = 1.3694e-01, PNorm = 35.3852, GNorm = 1.5428, lr_0 = 3.6009e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 31
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 32
Loss = 1.8899e-01, PNorm = 35.4237, GNorm = 1.2008, lr_0 = 3.3745e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 33
Loss = 1.7649e-01, PNorm = 35.4580, GNorm = 1.5592, lr_0 = 3.1810e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 34
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.545455
Epoch 35
Loss = 1.9260e-01, PNorm = 35.4940, GNorm = 3.2894, lr_0 = 2.9810e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 36
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 37
Loss = 1.5334e-01, PNorm = 35.5268, GNorm = 2.4020, lr_0 = 2.7935e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 38
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 39
Loss = 1.0605e-01, PNorm = 35.5558, GNorm = 0.4652, lr_0 = 2.6334e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 40
Loss = 1.4901e-01, PNorm = 35.5862, GNorm = 0.4121, lr_0 = 2.4678e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 41
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 42
Loss = 1.5018e-01, PNorm = 35.6130, GNorm = 0.8127, lr_0 = 2.3263e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.727273
Epoch 43
Validation auc = 0.066667
Validation prc-auc = 0.048485
Validation accuracy = 0.454545
Epoch 44
Loss = 2.0469e-01, PNorm = 35.6409, GNorm = 3.9019, lr_0 = 2.1800e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 45
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.727273
Epoch 46
Loss = 1.4843e-01, PNorm = 35.6678, GNorm = 2.1011, lr_0 = 2.0429e-04
Validation auc = 0.066667
Validation prc-auc = 0.048485
Validation accuracy = 0.454545
Epoch 47
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.545455
Epoch 48
Loss = 1.1714e-01, PNorm = 35.6906, GNorm = 0.5682, lr_0 = 1.9145e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 49
Loss = 1.3665e-01, PNorm = 35.7096, GNorm = 0.9997, lr_0 = 1.8047e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 50
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 51
Loss = 1.5255e-01, PNorm = 35.7295, GNorm = 1.2498, lr_0 = 1.6912e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 52
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 53
Loss = 1.1744e-01, PNorm = 35.7485, GNorm = 1.2122, lr_0 = 1.5849e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 54
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 55
Loss = 1.4566e-01, PNorm = 35.7632, GNorm = 0.7300, lr_0 = 1.4940e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 56
Loss = 1.2983e-01, PNorm = 35.7806, GNorm = 1.2528, lr_0 = 1.4001e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 57
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 58
Loss = 1.3580e-01, PNorm = 35.7960, GNorm = 0.7273, lr_0 = 1.3120e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 59
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.545455
Epoch 60
Loss = 1.0741e-01, PNorm = 35.8104, GNorm = 1.7602, lr_0 = 1.2368e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 61
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 62
Loss = 1.0041e-01, PNorm = 35.8243, GNorm = 0.9048, lr_0 = 1.1591e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 63
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 64
Loss = 1.0452e-01, PNorm = 35.8370, GNorm = 0.6289, lr_0 = 1.0862e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.545455
Epoch 65
Loss = 1.0688e-01, PNorm = 35.8470, GNorm = 1.5066, lr_0 = 1.0239e-04
Loss = 2.2421e-01, PNorm = 35.8479, GNorm = 1.4958, lr_0 = 1.0179e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 66
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 67
Loss = 1.2064e-01, PNorm = 35.8579, GNorm = 1.0955, lr_0 = 1.0000e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 68
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 69
Loss = 9.5481e-02, PNorm = 35.8692, GNorm = 0.5484, lr_0 = 1.0000e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 70
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.545455
Epoch 71
Loss = 1.4808e-01, PNorm = 35.8794, GNorm = 1.7457, lr_0 = 1.0000e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 72
Loss = 1.1815e-01, PNorm = 35.8906, GNorm = 0.9171, lr_0 = 1.0000e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 73
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.636364
Epoch 74
Loss = 1.2081e-01, PNorm = 35.9017, GNorm = 0.9464, lr_0 = 1.0000e-04
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 75
Validation auc = 0.133333
Validation prc-auc = 0.050954
Validation accuracy = 0.454545
Epoch 76
Loss = 1.2795e-01, PNorm = 35.9108, GNorm = 1.2061, lr_0 = 1.0000e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 77
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 78
Loss = 9.9045e-02, PNorm = 35.9212, GNorm = 1.0303, lr_0 = 1.0000e-04
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Epoch 79
Validation auc = 0.200000
Validation prc-auc = 0.054040
Validation accuracy = 0.454545
Model 2 best validation auc = 0.333333 on epoch 12
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.928571
Model 2 test prc-auc = 0.898384
Model 2 test accuracy = 0.897436
Ensemble test auc = 0.928571
Ensemble test prc-auc = 0.898384
Ensemble test accuracy = 0.820513
Fold 4
Splitting data with seed 4
Total scaffolds = 65 | train scaffolds = 51 | val scaffolds = 7 | test scaffolds = 7
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 33 | target average = 1.000000


Scaffold 1
Task 0: count = 24 | target average = 0.041667


Scaffold 2
Task 0: count = 21 | target average = 1.000000


Scaffold 3
Task 0: count = 21 | target average = 0.000000


Scaffold 4
Task 0: count = 14 | target average = 0.000000


Scaffold 5
Task 0: count = 12 | target average = 0.083333


Scaffold 6
Task 0: count = 9 | target average = 0.000000


Scaffold 7
Task 0: count = 7 | target average = 1.000000


Scaffold 8
Task 0: count = 6 | target average = 0.000000


Scaffold 9
Task 0: count = 6 | target average = 0.000000


Class sizes
bin_activity 0: 69.12%, 1: 30.88%
Total size = 353 | train size = 282 | val size = 33 | test size = 38
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.694444
Validation prc-auc = 0.343585
Validation accuracy = 0.727273
Epoch 1
Loss = 6.0768e-01, PNorm = 34.0289, GNorm = 0.8291, lr_0 = 9.8826e-04
Validation auc = 0.638889
Validation prc-auc = 0.310185
Validation accuracy = 0.727273
Epoch 2
Validation auc = 0.763889
Validation prc-auc = 0.608047
Validation accuracy = 0.727273
Epoch 3
Loss = 6.1417e-01, PNorm = 34.1007, GNorm = 0.7007, lr_0 = 9.2612e-04
Validation auc = 0.638889
Validation prc-auc = 0.310185
Validation accuracy = 0.727273
Epoch 4
Validation auc = 0.736111
Validation prc-auc = 0.593585
Validation accuracy = 0.727273
Epoch 5
Loss = 5.6404e-01, PNorm = 34.1841, GNorm = 0.3949, lr_0 = 8.7302e-04
Validation auc = 0.722222
Validation prc-auc = 0.588624
Validation accuracy = 0.727273
Epoch 6
Validation auc = 0.805556
Validation prc-auc = 0.783069
Validation accuracy = 0.727273
Epoch 7
Loss = 4.6782e-01, PNorm = 34.3017, GNorm = 2.2010, lr_0 = 8.1813e-04
Validation auc = 0.805556
Validation prc-auc = 0.783069
Validation accuracy = 0.727273
Epoch 8
Loss = 4.4381e-01, PNorm = 34.4229, GNorm = 2.7390, lr_0 = 7.7122e-04
Loss = 5.4367e-01, PNorm = 34.4333, GNorm = 4.3600, lr_0 = 7.6668e-04
Validation auc = 0.791667
Validation prc-auc = 0.658642
Validation accuracy = 0.727273
Epoch 9
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 10
Loss = 4.2183e-01, PNorm = 34.5419, GNorm = 3.5933, lr_0 = 7.2273e-04
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 11
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 12
Loss = 2.6021e-01, PNorm = 34.6670, GNorm = 1.3223, lr_0 = 6.7728e-04
Validation auc = 0.722222
Validation prc-auc = 0.394180
Validation accuracy = 0.727273
Epoch 13
Validation auc = 0.791667
Validation prc-auc = 0.434590
Validation accuracy = 0.727273
Epoch 14
Loss = 2.3057e-01, PNorm = 34.7814, GNorm = 0.6097, lr_0 = 6.3469e-04
Validation auc = 0.722222
Validation prc-auc = 0.394180
Validation accuracy = 0.727273
Epoch 15
Loss = 2.2868e-01, PNorm = 34.8888, GNorm = 1.3666, lr_0 = 5.9831e-04
Validation auc = 0.750000
Validation prc-auc = 0.408642
Validation accuracy = 0.727273
Epoch 16
Validation auc = 0.750000
Validation prc-auc = 0.408642
Validation accuracy = 0.727273
Epoch 17
Loss = 1.7515e-01, PNorm = 34.9844, GNorm = 0.4424, lr_0 = 5.6068e-04
Validation auc = 0.750000
Validation prc-auc = 0.408642
Validation accuracy = 0.727273
Epoch 18
Validation auc = 0.722222
Validation prc-auc = 0.394180
Validation accuracy = 0.727273
Epoch 19
Loss = 1.7215e-01, PNorm = 35.0641, GNorm = 3.0845, lr_0 = 5.2854e-04
Validation auc = 0.805556
Validation prc-auc = 0.663602
Validation accuracy = 0.727273
Epoch 20
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 21
Loss = 1.2534e-01, PNorm = 35.1259, GNorm = 1.7589, lr_0 = 4.9530e-04
Validation auc = 0.763889
Validation prc-auc = 0.413602
Validation accuracy = 0.727273
Epoch 22
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 23
Loss = 1.2423e-01, PNorm = 35.1847, GNorm = 1.0738, lr_0 = 4.6416e-04
Validation auc = 0.763889
Validation prc-auc = 0.413602
Validation accuracy = 0.727273
Epoch 24
Loss = 1.1228e-01, PNorm = 35.2236, GNorm = 0.5965, lr_0 = 4.3755e-04
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 25
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 26
Loss = 1.3816e-01, PNorm = 35.2589, GNorm = 2.0132, lr_0 = 4.1003e-04
Validation auc = 0.763889
Validation prc-auc = 0.413602
Validation accuracy = 0.727273
Epoch 27
Validation auc = 0.722222
Validation prc-auc = 0.394180
Validation accuracy = 0.727273
Epoch 28
Loss = 1.3319e-01, PNorm = 35.2889, GNorm = 2.1212, lr_0 = 3.8425e-04
Validation auc = 0.694444
Validation prc-auc = 0.383598
Validation accuracy = 0.727273
Epoch 29
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 30
Loss = 2.4795e-02, PNorm = 35.3106, GNorm = 0.4814, lr_0 = 3.6222e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 31
Loss = 1.0690e-01, PNorm = 35.3341, GNorm = 1.0159, lr_0 = 3.3944e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 32
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 33
Loss = 8.5470e-02, PNorm = 35.3499, GNorm = 1.2585, lr_0 = 3.1998e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 34
Validation auc = 0.694444
Validation prc-auc = 0.383598
Validation accuracy = 0.727273
Epoch 35
Loss = 8.4504e-02, PNorm = 35.3690, GNorm = 0.7001, lr_0 = 2.9986e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 36
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 37
Loss = 9.9427e-02, PNorm = 35.3864, GNorm = 2.5096, lr_0 = 2.8101e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 38
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 39
Loss = 1.8089e-01, PNorm = 35.3996, GNorm = 0.9644, lr_0 = 2.6334e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 40
Loss = 9.8459e-02, PNorm = 35.4135, GNorm = 2.6637, lr_0 = 2.4824e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 41
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 42
Loss = 1.0533e-01, PNorm = 35.4256, GNorm = 1.3958, lr_0 = 2.3263e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 43
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 44
Loss = 1.1878e-01, PNorm = 35.4369, GNorm = 1.4002, lr_0 = 2.1929e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 45
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 46
Loss = 9.8484e-02, PNorm = 35.4458, GNorm = 1.5105, lr_0 = 2.0550e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 47
Loss = 9.1907e-02, PNorm = 35.4534, GNorm = 0.2647, lr_0 = 1.9372e-04
Loss = 3.6714e-02, PNorm = 35.4544, GNorm = 0.7065, lr_0 = 1.9258e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 48
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 49
Loss = 1.0067e-01, PNorm = 35.4626, GNorm = 0.6005, lr_0 = 1.8154e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 50
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 51
Loss = 8.4328e-02, PNorm = 35.4702, GNorm = 2.0942, lr_0 = 1.7013e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 52
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 53
Loss = 5.1685e-02, PNorm = 35.4784, GNorm = 0.6417, lr_0 = 1.5943e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 54
Loss = 7.9302e-02, PNorm = 35.4842, GNorm = 0.2586, lr_0 = 1.5029e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 55
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 56
Loss = 8.7491e-02, PNorm = 35.4917, GNorm = 1.1209, lr_0 = 1.4084e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 57
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 58
Loss = 7.2847e-02, PNorm = 35.4970, GNorm = 1.1020, lr_0 = 1.3276e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 59
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 60
Loss = 1.2117e-01, PNorm = 35.5028, GNorm = 1.2377, lr_0 = 1.2441e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 61
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 62
Loss = 2.3187e-02, PNorm = 35.5089, GNorm = 0.7026, lr_0 = 1.1659e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 63
Loss = 8.1653e-02, PNorm = 35.5131, GNorm = 0.9527, lr_0 = 1.0991e-04
Loss = 7.7091e-02, PNorm = 35.5136, GNorm = 1.7287, lr_0 = 1.0926e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 64
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 65
Loss = 1.0432e-01, PNorm = 35.5175, GNorm = 4.3468, lr_0 = 1.0300e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 66
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 67
Loss = 5.7579e-02, PNorm = 35.5234, GNorm = 1.5741, lr_0 = 1.0000e-04
Validation auc = 0.694444
Validation prc-auc = 0.384259
Validation accuracy = 0.727273
Epoch 68
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 69
Loss = 2.8201e-02, PNorm = 35.5274, GNorm = 0.9905, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 70
Loss = 9.2411e-02, PNorm = 35.5317, GNorm = 5.4217, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 71
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 72
Loss = 5.2495e-02, PNorm = 35.5364, GNorm = 1.4562, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 73
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Epoch 74
Loss = 1.1303e-01, PNorm = 35.5403, GNorm = 1.2893, lr_0 = 1.0000e-04
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Epoch 75
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 76
Loss = 1.2448e-01, PNorm = 35.5448, GNorm = 0.7257, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 77
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Epoch 78
Loss = 2.2203e-02, PNorm = 35.5478, GNorm = 0.7062, lr_0 = 1.0000e-04
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Epoch 79
Loss = 8.4017e-02, PNorm = 35.5518, GNorm = 0.4807, lr_0 = 1.0000e-04
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Model 0 best validation auc = 0.833333 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test auc = 0.460938
Model 0 test prc-auc = 0.131944
Model 0 test accuracy = 0.842105
Building model 1
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.722222
Validation prc-auc = 0.577491
Validation accuracy = 0.727273
Epoch 1
Loss = 6.3186e-01, PNorm = 34.0187, GNorm = 0.2044, lr_0 = 9.8826e-04
Validation auc = 0.638889
Validation prc-auc = 0.310185
Validation accuracy = 0.727273
Epoch 2
Validation auc = 0.638889
Validation prc-auc = 0.310185
Validation accuracy = 0.727273
Epoch 3
Loss = 6.0264e-01, PNorm = 34.0869, GNorm = 0.1844, lr_0 = 9.2612e-04
Validation auc = 0.638889
Validation prc-auc = 0.310185
Validation accuracy = 0.727273
Epoch 4
Validation auc = 0.652778
Validation prc-auc = 0.316975
Validation accuracy = 0.727273
Epoch 5
Loss = 5.4574e-01, PNorm = 34.1729, GNorm = 0.8852, lr_0 = 8.7302e-04
Validation auc = 0.736111
Validation prc-auc = 0.593585
Validation accuracy = 0.727273
Epoch 6
Validation auc = 0.680556
Validation prc-auc = 0.558069
Validation accuracy = 0.727273
Epoch 7
Loss = 5.0002e-01, PNorm = 34.2830, GNorm = 0.9697, lr_0 = 8.1813e-04
Validation auc = 0.652778
Validation prc-auc = 0.547487
Validation accuracy = 0.727273
Epoch 8
Loss = 4.5552e-01, PNorm = 34.3994, GNorm = 3.4622, lr_0 = 7.7122e-04
Loss = 4.9405e-01, PNorm = 34.4108, GNorm = 2.3104, lr_0 = 7.6668e-04
Validation auc = 0.694444
Validation prc-auc = 0.578042
Validation accuracy = 0.727273
Epoch 9
Validation auc = 0.722222
Validation prc-auc = 0.577491
Validation accuracy = 0.727273
Epoch 10
Loss = 4.2409e-01, PNorm = 34.5135, GNorm = 0.4559, lr_0 = 7.2273e-04
Validation auc = 0.722222
Validation prc-auc = 0.577491
Validation accuracy = 0.727273
Epoch 11
Validation auc = 0.805556
Validation prc-auc = 0.663602
Validation accuracy = 0.727273
Epoch 12
Loss = 3.6207e-01, PNorm = 34.6451, GNorm = 1.1083, lr_0 = 6.7728e-04
Validation auc = 0.791667
Validation prc-auc = 0.629034
Validation accuracy = 0.727273
Epoch 13
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 14
Loss = 2.5796e-01, PNorm = 34.7820, GNorm = 1.7876, lr_0 = 6.3469e-04
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 15
Loss = 3.7925e-01, PNorm = 34.8744, GNorm = 12.6887, lr_0 = 5.9831e-04
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 16
Validation auc = 0.791667
Validation prc-auc = 0.434590
Validation accuracy = 0.727273
Epoch 17
Loss = 2.9786e-01, PNorm = 34.9534, GNorm = 2.6885, lr_0 = 5.6068e-04
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 18
Validation auc = 0.791667
Validation prc-auc = 0.434590
Validation accuracy = 0.636364
Epoch 19
Loss = 2.3712e-01, PNorm = 35.0154, GNorm = 2.6578, lr_0 = 5.2854e-04
Validation auc = 0.777778
Validation prc-auc = 0.649140
Validation accuracy = 0.727273
Epoch 20
Validation auc = 0.722222
Validation prc-auc = 0.394180
Validation accuracy = 0.727273
Epoch 21
Loss = 1.7724e-01, PNorm = 35.0802, GNorm = 1.8592, lr_0 = 4.9530e-04
Validation auc = 0.791667
Validation prc-auc = 0.434590
Validation accuracy = 0.727273
Epoch 22
Validation auc = 0.694444
Validation prc-auc = 0.383598
Validation accuracy = 0.727273
Epoch 23
Loss = 2.4509e-01, PNorm = 35.1380, GNorm = 1.3645, lr_0 = 4.6416e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 24
Loss = 1.3850e-01, PNorm = 35.1830, GNorm = 3.2521, lr_0 = 4.3755e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 25
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 26
Loss = 1.0729e-01, PNorm = 35.2284, GNorm = 0.8503, lr_0 = 4.1003e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 27
Validation auc = 0.777778
Validation prc-auc = 0.649140
Validation accuracy = 0.727273
Epoch 28
Loss = 1.2779e-01, PNorm = 35.2656, GNorm = 1.3948, lr_0 = 3.8425e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 29
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 30
Loss = 1.0053e-01, PNorm = 35.2957, GNorm = 2.9599, lr_0 = 3.6222e-04
Validation auc = 0.736111
Validation prc-auc = 0.399140
Validation accuracy = 0.727273
Epoch 31
Loss = 1.2393e-01, PNorm = 35.3257, GNorm = 5.4775, lr_0 = 3.3944e-04
Validation auc = 0.694444
Validation prc-auc = 0.383598
Validation accuracy = 0.727273
Epoch 32
Validation auc = 0.763889
Validation prc-auc = 0.643519
Validation accuracy = 0.727273
Epoch 33
Loss = 1.4493e-01, PNorm = 35.3505, GNorm = 1.0190, lr_0 = 3.1998e-04
Validation auc = 0.680556
Validation prc-auc = 0.379299
Validation accuracy = 0.727273
Epoch 34
Validation auc = 0.777778
Validation prc-auc = 0.650309
Validation accuracy = 0.727273
Epoch 35
Loss = 9.2376e-02, PNorm = 35.3749, GNorm = 0.3561, lr_0 = 2.9986e-04
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Epoch 36
Validation auc = 0.750000
Validation prc-auc = 0.641049
Validation accuracy = 0.727273
Epoch 37
Loss = 1.5193e-01, PNorm = 35.3962, GNorm = 1.5630, lr_0 = 2.8101e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 38
Validation auc = 0.777778
Validation prc-auc = 0.650309
Validation accuracy = 0.727273
Epoch 39
Loss = 5.6151e-02, PNorm = 35.4135, GNorm = 1.0356, lr_0 = 2.6334e-04
Validation auc = 0.708333
Validation prc-auc = 0.391049
Validation accuracy = 0.727273
Epoch 40
Loss = 8.6146e-02, PNorm = 35.4304, GNorm = 0.5348, lr_0 = 2.4824e-04
Validation auc = 0.736111
Validation prc-auc = 0.634259
Validation accuracy = 0.727273
Epoch 41
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 42
Loss = 1.2574e-01, PNorm = 35.4445, GNorm = 1.0307, lr_0 = 2.3263e-04
Validation auc = 0.777778
Validation prc-auc = 0.650309
Validation accuracy = 0.727273
Epoch 43
Validation auc = 0.694444
Validation prc-auc = 0.384259
Validation accuracy = 0.727273
Epoch 44
Loss = 9.6374e-02, PNorm = 35.4587, GNorm = 1.0095, lr_0 = 2.1929e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 45
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 46
Loss = 3.8533e-02, PNorm = 35.4712, GNorm = 1.4930, lr_0 = 2.0550e-04
Validation auc = 0.708333
Validation prc-auc = 0.391049
Validation accuracy = 0.727273
Epoch 47
Loss = 8.0632e-02, PNorm = 35.4828, GNorm = 1.3309, lr_0 = 1.9372e-04
Loss = 1.9786e-01, PNorm = 35.4836, GNorm = 1.7033, lr_0 = 1.9258e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 48
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 49
Loss = 7.3864e-02, PNorm = 35.4923, GNorm = 1.7086, lr_0 = 1.8154e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 50
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 51
Loss = 9.6794e-02, PNorm = 35.5022, GNorm = 1.0796, lr_0 = 1.7013e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 52
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 53
Loss = 2.8402e-02, PNorm = 35.5120, GNorm = 1.0097, lr_0 = 1.5943e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 54
Loss = 8.7914e-02, PNorm = 35.5182, GNorm = 0.7606, lr_0 = 1.5029e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 55
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 56
Loss = 9.5901e-02, PNorm = 35.5266, GNorm = 0.4569, lr_0 = 1.4084e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 57
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 58
Loss = 7.4014e-02, PNorm = 35.5330, GNorm = 2.4365, lr_0 = 1.3276e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 59
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 60
Loss = 8.3386e-02, PNorm = 35.5386, GNorm = 0.6571, lr_0 = 1.2441e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 61
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 62
Loss = 4.1607e-02, PNorm = 35.5448, GNorm = 1.4528, lr_0 = 1.1659e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 63
Loss = 9.6038e-02, PNorm = 35.5504, GNorm = 3.2123, lr_0 = 1.0991e-04
Loss = 2.0931e-02, PNorm = 35.5510, GNorm = 0.7169, lr_0 = 1.0926e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 64
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 65
Loss = 8.9647e-02, PNorm = 35.5561, GNorm = 1.4709, lr_0 = 1.0300e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 66
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 67
Loss = 4.5261e-02, PNorm = 35.5617, GNorm = 0.6203, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 68
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 69
Loss = 3.5491e-02, PNorm = 35.5665, GNorm = 1.6266, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 70
Loss = 9.3826e-02, PNorm = 35.5716, GNorm = 1.9128, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 71
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 72
Loss = 6.0097e-02, PNorm = 35.5763, GNorm = 0.3817, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 73
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 74
Loss = 9.7651e-02, PNorm = 35.5816, GNorm = 2.6986, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 75
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 76
Loss = 7.0053e-02, PNorm = 35.5871, GNorm = 0.9023, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 77
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 78
Loss = 5.2251e-02, PNorm = 35.5910, GNorm = 1.5650, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 79
Loss = 9.0665e-02, PNorm = 35.5956, GNorm = 2.6988, lr_0 = 1.0000e-04
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Model 1 best validation auc = 0.833333 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 1 test auc = 0.268229
Model 1 test prc-auc = 0.099706
Model 1 test accuracy = 0.763158
Building model 2
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation auc = 0.611111
Validation prc-auc = 0.300926
Validation accuracy = 0.727273
Epoch 1
Loss = 6.0871e-01, PNorm = 34.0386, GNorm = 1.0475, lr_0 = 9.8826e-04
Validation auc = 0.652778
Validation prc-auc = 0.328704
Validation accuracy = 0.727273
Epoch 2
Validation auc = 0.708333
Validation prc-auc = 0.584715
Validation accuracy = 0.727273
Epoch 3
Loss = 5.8540e-01, PNorm = 34.1194, GNorm = 0.4128, lr_0 = 9.2612e-04
Validation auc = 0.791667
Validation prc-auc = 0.779159
Validation accuracy = 0.727273
Epoch 4
Validation auc = 0.805556
Validation prc-auc = 0.783069
Validation accuracy = 0.727273
Epoch 5
Loss = 5.2014e-01, PNorm = 34.1901, GNorm = 0.9080, lr_0 = 8.7302e-04
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 6
Validation auc = 0.777778
Validation prc-auc = 0.772487
Validation accuracy = 0.727273
Epoch 7
Loss = 5.3351e-01, PNorm = 34.2920, GNorm = 1.0990, lr_0 = 8.1813e-04
Validation auc = 0.791667
Validation prc-auc = 0.658642
Validation accuracy = 0.727273
Epoch 8
Loss = 4.4667e-01, PNorm = 34.3958, GNorm = 0.3472, lr_0 = 7.7122e-04
Loss = 3.8714e-01, PNorm = 34.4076, GNorm = 1.2082, lr_0 = 7.6668e-04
Validation auc = 0.791667
Validation prc-auc = 0.658642
Validation accuracy = 0.727273
Epoch 9
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 10
Loss = 4.2871e-01, PNorm = 34.5108, GNorm = 2.1066, lr_0 = 7.2273e-04
Validation auc = 0.791667
Validation prc-auc = 0.658642
Validation accuracy = 0.727273
Epoch 11
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 12
Loss = 3.9741e-01, PNorm = 34.6239, GNorm = 1.5692, lr_0 = 6.7728e-04
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 13
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 14
Loss = 2.9562e-01, PNorm = 34.7331, GNorm = 2.6193, lr_0 = 6.3469e-04
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 15
Loss = 2.4250e-01, PNorm = 34.8328, GNorm = 1.7386, lr_0 = 5.9831e-04
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 16
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.818182
Epoch 17
Loss = 2.1280e-01, PNorm = 34.9371, GNorm = 4.1597, lr_0 = 5.6068e-04
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.818182
Epoch 18
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 19
Loss = 1.7661e-01, PNorm = 35.0213, GNorm = 2.3969, lr_0 = 5.2854e-04
Validation auc = 0.791667
Validation prc-auc = 0.658642
Validation accuracy = 0.727273
Epoch 20
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 21
Loss = 1.5368e-01, PNorm = 35.0936, GNorm = 2.9468, lr_0 = 4.9530e-04
Validation auc = 0.791667
Validation prc-auc = 0.658642
Validation accuracy = 0.727273
Epoch 22
Validation auc = 0.819444
Validation prc-auc = 0.679630
Validation accuracy = 0.727273
Epoch 23
Loss = 1.8481e-01, PNorm = 35.1542, GNorm = 3.7389, lr_0 = 4.6416e-04
Validation auc = 0.819444
Validation prc-auc = 0.679630
Validation accuracy = 0.727273
Epoch 24
Loss = 1.2693e-01, PNorm = 35.1987, GNorm = 1.2239, lr_0 = 4.3755e-04
Validation auc = 0.791667
Validation prc-auc = 0.658642
Validation accuracy = 0.727273
Epoch 25
Validation auc = 0.833333
Validation prc-auc = 0.684590
Validation accuracy = 0.727273
Epoch 26
Loss = 1.2079e-01, PNorm = 35.2363, GNorm = 0.7986, lr_0 = 4.1003e-04
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 27
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 28
Loss = 1.0148e-01, PNorm = 35.2749, GNorm = 4.2032, lr_0 = 3.8425e-04
Validation auc = 0.847222
Validation prc-auc = 0.691093
Validation accuracy = 0.727273
Epoch 29
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 30
Loss = 1.6898e-01, PNorm = 35.3069, GNorm = 1.2427, lr_0 = 3.6222e-04
Validation auc = 0.763889
Validation prc-auc = 0.644180
Validation accuracy = 0.727273
Epoch 31
Loss = 9.5891e-02, PNorm = 35.3383, GNorm = 1.2214, lr_0 = 3.3944e-04
Validation auc = 0.819444
Validation prc-auc = 0.670106
Validation accuracy = 0.727273
Epoch 32
Validation auc = 0.805556
Validation prc-auc = 0.663602
Validation accuracy = 0.727273
Epoch 33
Loss = 1.1834e-01, PNorm = 35.3622, GNorm = 2.4185, lr_0 = 3.1998e-04
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 34
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 35
Loss = 7.3612e-02, PNorm = 35.3853, GNorm = 1.0486, lr_0 = 2.9986e-04
Validation auc = 0.805556
Validation prc-auc = 0.663602
Validation accuracy = 0.727273
Epoch 36
Validation auc = 0.819444
Validation prc-auc = 0.670106
Validation accuracy = 0.727273
Epoch 37
Loss = 6.0326e-02, PNorm = 35.4045, GNorm = 1.7604, lr_0 = 2.8101e-04
Validation auc = 0.736111
Validation prc-auc = 0.633598
Validation accuracy = 0.727273
Epoch 38
Validation auc = 0.805556
Validation prc-auc = 0.662434
Validation accuracy = 0.727273
Epoch 39
Loss = 1.9390e-01, PNorm = 35.4236, GNorm = 2.1329, lr_0 = 2.6334e-04
Validation auc = 0.777778
Validation prc-auc = 0.650309
Validation accuracy = 0.727273
Epoch 40
Loss = 9.4675e-02, PNorm = 35.4389, GNorm = 1.5821, lr_0 = 2.4824e-04
Validation auc = 0.805556
Validation prc-auc = 0.662434
Validation accuracy = 0.727273
Epoch 41
Validation auc = 0.694444
Validation prc-auc = 0.384259
Validation accuracy = 0.727273
Epoch 42
Loss = 7.2794e-02, PNorm = 35.4520, GNorm = 2.2869, lr_0 = 2.3263e-04
Validation auc = 0.763889
Validation prc-auc = 0.412434
Validation accuracy = 0.727273
Epoch 43
Validation auc = 0.722222
Validation prc-auc = 0.629299
Validation accuracy = 0.727273
Epoch 44
Loss = 8.4125e-02, PNorm = 35.4661, GNorm = 2.1395, lr_0 = 2.1929e-04
Validation auc = 0.791667
Validation prc-auc = 0.660185
Validation accuracy = 0.727273
Epoch 45
Validation auc = 0.722222
Validation prc-auc = 0.393519
Validation accuracy = 0.727273
Epoch 46
Loss = 1.3635e-01, PNorm = 35.4792, GNorm = 0.8278, lr_0 = 2.0550e-04
Validation auc = 0.763889
Validation prc-auc = 0.643519
Validation accuracy = 0.727273
Epoch 47
Loss = 1.1423e-01, PNorm = 35.4914, GNorm = 1.4317, lr_0 = 1.9372e-04
Loss = 2.8419e-02, PNorm = 35.4927, GNorm = 0.4607, lr_0 = 1.9258e-04
Validation auc = 0.722222
Validation prc-auc = 0.629299
Validation accuracy = 0.727273
Epoch 48
Validation auc = 0.763889
Validation prc-auc = 0.643519
Validation accuracy = 0.727273
Epoch 49
Loss = 8.8968e-02, PNorm = 35.5020, GNorm = 0.8626, lr_0 = 1.8154e-04
Validation auc = 0.777778
Validation prc-auc = 0.422310
Validation accuracy = 0.727273
Epoch 50
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 51
Loss = 7.3665e-02, PNorm = 35.5119, GNorm = 1.4640, lr_0 = 1.7013e-04
Validation auc = 0.791667
Validation prc-auc = 0.660185
Validation accuracy = 0.727273
Epoch 52
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 53
Loss = 1.1986e-01, PNorm = 35.5212, GNorm = 1.1312, lr_0 = 1.5943e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 54
Loss = 8.7642e-02, PNorm = 35.5299, GNorm = 0.3679, lr_0 = 1.5029e-04
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Epoch 55
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 56
Loss = 8.5451e-02, PNorm = 35.5365, GNorm = 1.5144, lr_0 = 1.4084e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 57
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 58
Loss = 5.6768e-02, PNorm = 35.5436, GNorm = 0.5712, lr_0 = 1.3276e-04
Validation auc = 0.736111
Validation prc-auc = 0.400309
Validation accuracy = 0.727273
Epoch 59
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 60
Loss = 3.3855e-02, PNorm = 35.5495, GNorm = 1.4934, lr_0 = 1.2441e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 61
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 62
Loss = 5.2196e-02, PNorm = 35.5559, GNorm = 0.8411, lr_0 = 1.1659e-04
Validation auc = 0.708333
Validation prc-auc = 0.391049
Validation accuracy = 0.727273
Epoch 63
Loss = 7.8457e-02, PNorm = 35.5620, GNorm = 1.6964, lr_0 = 1.0991e-04
Loss = 9.7249e-02, PNorm = 35.5624, GNorm = 2.7072, lr_0 = 1.0926e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 64
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 65
Loss = 8.9842e-02, PNorm = 35.5670, GNorm = 2.4133, lr_0 = 1.0300e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 66
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 67
Loss = 8.9811e-02, PNorm = 35.5716, GNorm = 2.0398, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 68
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 69
Loss = 7.2149e-02, PNorm = 35.5761, GNorm = 1.6582, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 70
Loss = 7.9098e-02, PNorm = 35.5806, GNorm = 1.0196, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 71
Validation auc = 0.722222
Validation prc-auc = 0.400926
Validation accuracy = 0.727273
Epoch 72
Loss = 7.5784e-02, PNorm = 35.5854, GNorm = 3.2468, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 73
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 74
Loss = 7.0030e-02, PNorm = 35.5898, GNorm = 1.3870, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 75
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 76
Loss = 8.4727e-02, PNorm = 35.5942, GNorm = 0.5033, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 77
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 78
Loss = 2.1356e-02, PNorm = 35.5991, GNorm = 0.5495, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Epoch 79
Loss = 1.0382e-01, PNorm = 35.6031, GNorm = 2.0275, lr_0 = 1.0000e-04
Validation auc = 0.750000
Validation prc-auc = 0.410185
Validation accuracy = 0.727273
Model 2 best validation auc = 0.847222 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 2 test auc = 0.039062
Model 2 test prc-auc = 0.081684
Model 2 test accuracy = 0.842105
Ensemble test auc = 0.346354
Ensemble test prc-auc = 0.109878
Ensemble test accuracy = 0.763158
5-fold cross validation
	Seed 0 ==> test auc = 0.734375
	Seed 0 ==> test prc-auc = 0.218056
	Seed 0 ==> test accuracy = 0.888889
	Seed 1 ==> test auc = 0.741071
	Seed 1 ==> test prc-auc = 0.592582
	Seed 1 ==> test accuracy = 0.820513
	Seed 2 ==> test auc = 0.928571
	Seed 2 ==> test prc-auc = 0.767857
	Seed 2 ==> test accuracy = 0.820513
	Seed 3 ==> test auc = 0.928571
	Seed 3 ==> test prc-auc = 0.898384
	Seed 3 ==> test accuracy = 0.820513
	Seed 4 ==> test auc = 0.346354
	Seed 4 ==> test prc-auc = 0.109878
	Seed 4 ==> test accuracy = 0.763158
Overall test auc = 0.735789 +/- 0.212612
Overall test prc-auc = 0.517352 +/- 0.306337
Overall test accuracy = 0.822717 +/- 0.039851
Elapsed time = 0:09:15
